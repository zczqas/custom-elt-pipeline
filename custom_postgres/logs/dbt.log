[0m06:07:21.045501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8720914f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8721cfc980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8720914fb0>]}


============================== 06:07:21.051216 | 5a2afd64-bc3e-4f75-8451-1264a7fbbf74 ==============================
[0m06:07:21.051216 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:07:21.051636 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'send_anonymous_usage_stats': 'True'}
[0m06:07:21.053570 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'default'
[0m06:07:21.054263 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.055266418, "process_in_blocks": "0", "process_kernel_time": 0.203973, "process_mem_max_rss": "86260", "process_out_blocks": "1480", "process_user_time": 1.08386}
[0m06:07:21.054642 [debug] [MainThread]: Command `dbt run` failed at 06:07:21.054561 after 0.06 seconds
[0m06:07:21.054879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8720a0b950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f871fda4560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f871fda45c0>]}
[0m06:07:21.055134 [debug] [MainThread]: Flushing usage events
[0m06:07:22.210861 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:08:27.135632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78659c135520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78659bf37530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78659c136540>]}


============================== 06:08:27.143141 | 09337b26-e537-40b1-a6a5-9d00e0fa0b8a ==============================
[0m06:08:27.143141 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:08:27.143531 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/root', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:08:27.145499 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'default'
[0m06:08:27.146168 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.053206716, "process_in_blocks": "0", "process_kernel_time": 0.192522, "process_mem_max_rss": "86480", "process_out_blocks": "1472", "process_user_time": 0.960617}
[0m06:08:27.146541 [debug] [MainThread]: Command `dbt run` failed at 06:08:27.146465 after 0.05 seconds
[0m06:08:27.146784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78659c24ee10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78659c795a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78659c0a9be0>]}
[0m06:08:27.147109 [debug] [MainThread]: Flushing usage events
[0m06:08:28.267723 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:11:22.670388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70abc0113cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70abc2ef1970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70abc0420cb0>]}


============================== 06:11:22.676086 | 6a8cf64d-6623-4e9b-94ee-61ae98f79e97 ==============================
[0m06:11:22.676086 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:11:22.676502 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root', 'version_check': 'True', 'debug': 'False', 'log_path': '/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'send_anonymous_usage_stats': 'True'}
[0m06:11:22.678417 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'default'
[0m06:11:22.679227 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.04891136, "process_in_blocks": "0", "process_kernel_time": 0.20787, "process_mem_max_rss": "86612", "process_out_blocks": "1472", "process_user_time": 0.966399}
[0m06:11:22.679663 [debug] [MainThread]: Command `dbt run` failed at 06:11:22.679578 after 0.05 seconds
[0m06:11:22.679957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70abc0b136b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70abc03f5a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70abc0a9d6a0>]}
[0m06:11:22.680236 [debug] [MainThread]: Flushing usage events
[0m06:11:23.831022 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:11:32.128954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76117399bb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76117533c920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x761173970980>]}


============================== 06:11:32.134369 | e3167e4c-4444-4306-8610-3e9ce4f99093 ==============================
[0m06:11:32.134369 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:11:32.134751 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:11:32.311959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e3167e4c-4444-4306-8610-3e9ce4f99093', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7611733a3f80>]}
[0m06:11:32.364058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e3167e4c-4444-4306-8610-3e9ce4f99093', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x761173b01ac0>]}
[0m06:11:32.364688 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:11:32.465989 [debug] [MainThread]: checksum: 568f1e1480817ea4790fb17980df195247d39d7f280a19e6fa3c1e276e1d1417, vars: {}, profile: custom_postgres, target: dev, version: 1.9.0
[0m06:11:32.466542 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:11:32.466803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e3167e4c-4444-4306-8610-3e9ce4f99093', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x761171b08440>]}
[0m06:11:33.379460 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid models config given in models/example/schema.yml @ models: {'name': 'actors', 'description': 'This table contains details about actors.', 'columns': [{'name': 'actor_id', 'description': 'Unique identifier for the actor.', 'tests': ['unique', 'not_null']}, {'name': 'name', 'description': 'First name of the actor.', 'tests': None}], 'original_file_path': 'models/example/schema.yml', 'yaml_key': 'models', 'package_name': 'custom_postgres'} - at path ['columns'][1]['tests']: None is not of type 'array'
[0m06:11:33.380547 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.2926584, "process_in_blocks": "0", "process_kernel_time": 0.242725, "process_mem_max_rss": "99528", "process_out_blocks": "1504", "process_user_time": 2.171542}
[0m06:11:33.380942 [debug] [MainThread]: Command `dbt run` failed at 06:11:33.380856 after 1.29 seconds
[0m06:11:33.381246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x761173b94440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x761171835460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7611716fd010>]}
[0m06:11:33.381523 [debug] [MainThread]: Flushing usage events
[0m06:11:34.480495 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:12:45.420675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793e682f62a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793e6711b2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793e68430740>]}


============================== 06:12:45.427036 | cd0f7336-07f4-4019-90bd-bf4cba77a12e ==============================
[0m06:12:45.427036 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:12:45.427458 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'version_check': 'True', 'profiles_dir': '/root', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:12:45.605167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd0f7336-07f4-4019-90bd-bf4cba77a12e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793e683b3b60>]}
[0m06:12:45.657332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd0f7336-07f4-4019-90bd-bf4cba77a12e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793e6643a0f0>]}
[0m06:12:45.657896 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:12:45.743861 [debug] [MainThread]: checksum: 568f1e1480817ea4790fb17980df195247d39d7f280a19e6fa3c1e276e1d1417, vars: {}, profile: custom_postgres, target: dev, version: 1.9.0
[0m06:12:45.744393 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:12:45.744660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cd0f7336-07f4-4019-90bd-bf4cba77a12e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793e667b1340>]}
[0m06:12:46.646933 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid models config given in models/example/schema.yml @ models: {'name': 'actors', 'description': 'This table contains details about actors.', 'columns': [{'name': 'actor_id', 'description': 'Unique identifier for the actor.', 'tests': ['unique', 'not_null']}, {'name': 'name', 'description': 'First name of the actor.', 'tests': None}], 'original_file_path': 'models/example/schema.yml', 'yaml_key': 'models', 'package_name': 'custom_postgres'} - at path ['columns'][1]['tests']: None is not of type 'array'
[0m06:12:46.648020 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.2690727, "process_in_blocks": "0", "process_kernel_time": 0.265753, "process_mem_max_rss": "99388", "process_out_blocks": "1504", "process_user_time": 2.146006}
[0m06:12:46.648563 [debug] [MainThread]: Command `dbt run` failed at 06:12:46.648446 after 1.27 seconds
[0m06:12:46.648902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793e666eb1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793e64bed460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793e64950f50>]}
[0m06:12:46.649195 [debug] [MainThread]: Flushing usage events
[0m06:12:47.759582 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:13:40.973536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1c8a2a61b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1c8a2a5370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1c8a4098e0>]}


============================== 06:13:40.978896 | f314d2e0-57d7-4e3e-9768-e88dadfbf486 ==============================
[0m06:13:40.978896 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:13:40.979324 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'profiles_dir': '/root', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:13:41.166241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f314d2e0-57d7-4e3e-9768-e88dadfbf486', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1c89def6e0>]}
[0m06:13:41.221044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f314d2e0-57d7-4e3e-9768-e88dadfbf486', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1c8a8e9700>]}
[0m06:13:41.221763 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:13:41.310697 [debug] [MainThread]: checksum: 568f1e1480817ea4790fb17980df195247d39d7f280a19e6fa3c1e276e1d1417, vars: {}, profile: custom_postgres, target: dev, version: 1.9.0
[0m06:13:41.311246 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:13:41.311522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f314d2e0-57d7-4e3e-9768-e88dadfbf486', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1c884ecbc0>]}
[0m06:13:42.238397 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid models config given in models/example/schema.yml @ models: {'name': 'actors', 'description': 'This table contains details about actors.', 'columns': [{'name': 'actor_id', 'description': 'Unique identifier for the actor.', 'tests': ['unique', 'not_null']}, {'name': 'name', 'description': 'First name of the actor.', 'tests': None}], 'original_file_path': 'models/example/schema.yml', 'yaml_key': 'models', 'package_name': 'custom_postgres'} - at path ['columns'][1]['tests']: None is not of type 'array'
[0m06:13:42.239593 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3100495, "process_in_blocks": "0", "process_kernel_time": 0.249896, "process_mem_max_rss": "99780", "process_out_blocks": "1504", "process_user_time": 2.281051}
[0m06:13:42.240579 [debug] [MainThread]: Command `dbt run` failed at 06:13:42.240407 after 1.31 seconds
[0m06:13:42.240893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1c8a0a0980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1c88260500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1c88301820>]}
[0m06:13:42.241193 [debug] [MainThread]: Flushing usage events
[0m06:13:43.376146 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:15:07.565003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7835e6b44740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7835e4e4e210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7835e4d93b30>]}


============================== 06:15:07.569998 | be3080dc-0b84-47e2-b6df-2f5ad4751819 ==============================
[0m06:15:07.569998 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:15:07.570395 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/dbt/logs', 'profiles_dir': '/root', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:15:07.745461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be3080dc-0b84-47e2-b6df-2f5ad4751819', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7835e4ed1d00>]}
[0m06:15:07.797126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be3080dc-0b84-47e2-b6df-2f5ad4751819', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7835e583a810>]}
[0m06:15:07.797714 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:15:07.884857 [debug] [MainThread]: checksum: 568f1e1480817ea4790fb17980df195247d39d7f280a19e6fa3c1e276e1d1417, vars: {}, profile: custom_postgres, target: dev, version: 1.9.0
[0m06:15:07.885386 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:15:07.885644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'be3080dc-0b84-47e2-b6df-2f5ad4751819', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7835e32c0950>]}
[0m06:15:09.103530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be3080dc-0b84-47e2-b6df-2f5ad4751819', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7835e166b6b0>]}
[0m06:15:09.231639 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m06:15:09.233819 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m06:15:09.257762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be3080dc-0b84-47e2-b6df-2f5ad4751819', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7835e171f740>]}
[0m06:15:09.258189 [info ] [MainThread]: Found 4 models, 20 data tests, 3 sources, 429 macros
[0m06:15:09.258447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be3080dc-0b84-47e2-b6df-2f5ad4751819', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7835e166bc80>]}
[0m06:15:09.260470 [info ] [MainThread]: 
[0m06:15:09.260753 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:15:09.260994 [info ] [MainThread]: 
[0m06:15:09.261445 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:15:09.265472 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m06:15:09.300864 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m06:15:09.301189 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m06:15:09.301400 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:15:09.316687 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "host.docker.internal" to address: Name or service not known

[0m06:15:09.331273 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m06:15:09.331672 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m06:15:09.331928 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m06:15:09.332130 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m06:15:09.332333 [debug] [ThreadPool]: On list_destination_db: No close available on handle
[0m06:15:09.332945 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:15:09.333283 [debug] [MainThread]: Connection 'list_destination_db' was properly closed.
[0m06:15:09.333526 [info ] [MainThread]: 
[0m06:15:09.333788 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.07 seconds (0.07s).
[0m06:15:09.334213 [error] [MainThread]: Encountered an error:
Database Error
  could not translate host name "host.docker.internal" to address: Name or service not known
  
[0m06:15:09.335080 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.8100259, "process_in_blocks": "0", "process_kernel_time": 0.287264, "process_mem_max_rss": "108068", "process_out_blocks": "3488", "process_user_time": 2.634259}
[0m06:15:09.335488 [debug] [MainThread]: Command `dbt run` failed at 06:15:09.335402 after 1.81 seconds
[0m06:15:09.335765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7835e5265d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7835e2eb2390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7835e171d3a0>]}
[0m06:15:09.336051 [debug] [MainThread]: Flushing usage events
[0m06:15:10.616573 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:16:33.598684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711c15c9f920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711c15c9e570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711c16ce3a70>]}


============================== 06:16:33.605435 | 7fc9ea29-f6c1-44c1-a437-8bb3fdc7837d ==============================
[0m06:16:33.605435 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:16:33.605845 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'debug': 'False', 'profiles_dir': '/root', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:16:33.784206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7fc9ea29-f6c1-44c1-a437-8bb3fdc7837d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711c176b7380>]}
[0m06:16:33.837581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7fc9ea29-f6c1-44c1-a437-8bb3fdc7837d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711c178d9460>]}
[0m06:16:33.838309 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:16:33.923334 [debug] [MainThread]: checksum: 568f1e1480817ea4790fb17980df195247d39d7f280a19e6fa3c1e276e1d1417, vars: {}, profile: custom_postgres, target: dev, version: 1.9.0
[0m06:16:34.018330 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m06:16:34.018711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7fc9ea29-f6c1-44c1-a437-8bb3fdc7837d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711c13d4c050>]}
[0m06:16:35.182311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7fc9ea29-f6c1-44c1-a437-8bb3fdc7837d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711c12369040>]}
[0m06:16:35.307105 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m06:16:35.309303 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m06:16:35.331269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7fc9ea29-f6c1-44c1-a437-8bb3fdc7837d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711c1227f290>]}
[0m06:16:35.331644 [info ] [MainThread]: Found 4 models, 20 data tests, 3 sources, 429 macros
[0m06:16:35.331895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7fc9ea29-f6c1-44c1-a437-8bb3fdc7837d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711c13b06750>]}
[0m06:16:35.333612 [info ] [MainThread]: 
[0m06:16:35.333873 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:16:35.334110 [info ] [MainThread]: 
[0m06:16:35.334557 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:16:35.338390 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m06:16:35.373040 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m06:16:35.373334 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m06:16:35.373533 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:16:35.374886 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "destination_postgres" (172.18.0.2), port 5434 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m06:16:35.375841 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m06:16:35.376072 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m06:16:35.376329 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m06:16:35.376527 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m06:16:35.376730 [debug] [ThreadPool]: On list_destination_db: No close available on handle
[0m06:16:35.377222 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:16:35.377446 [debug] [MainThread]: Connection 'list_destination_db' was properly closed.
[0m06:16:35.377663 [info ] [MainThread]: 
[0m06:16:35.377919 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.04 seconds (0.04s).
[0m06:16:35.378364 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "destination_postgres" (172.18.0.2), port 5434 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m06:16:35.379164 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.8205575, "process_in_blocks": "0", "process_kernel_time": 0.268367, "process_mem_max_rss": "108392", "process_out_blocks": "3472", "process_user_time": 2.679684}
[0m06:16:35.379555 [debug] [MainThread]: Command `dbt run` failed at 06:16:35.379470 after 1.82 seconds
[0m06:16:35.379822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711c159d6ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711c13b95340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711c13b15730>]}
[0m06:16:35.380102 [debug] [MainThread]: Flushing usage events
[0m06:16:36.548818 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:17:54.527467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e9c2daa840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e9c2da8bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e9c3fa4530>]}


============================== 06:17:54.532440 | 5825cfa0-69d1-4d3c-8588-c213c1e6b111 ==============================
[0m06:17:54.532440 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:17:54.532828 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'profiles_dir': '/root', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:17:54.710320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5825cfa0-69d1-4d3c-8588-c213c1e6b111', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e9c2ba1ac0>]}
[0m06:17:54.762440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5825cfa0-69d1-4d3c-8588-c213c1e6b111', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e9c2efa000>]}
[0m06:17:54.762988 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:17:54.849771 [debug] [MainThread]: checksum: 568f1e1480817ea4790fb17980df195247d39d7f280a19e6fa3c1e276e1d1417, vars: {}, profile: custom_postgres, target: dev, version: 1.9.0
[0m06:17:54.941286 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m06:17:54.941667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5825cfa0-69d1-4d3c-8588-c213c1e6b111', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e9c30b45c0>]}
[0m06:17:56.099273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5825cfa0-69d1-4d3c-8588-c213c1e6b111', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e9c10afe30>]}
[0m06:17:56.223901 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m06:17:56.226107 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m06:17:56.248913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5825cfa0-69d1-4d3c-8588-c213c1e6b111', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e9c0f56bd0>]}
[0m06:17:56.249300 [info ] [MainThread]: Found 4 models, 20 data tests, 3 sources, 429 macros
[0m06:17:56.249566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5825cfa0-69d1-4d3c-8588-c213c1e6b111', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e9c2da6240>]}
[0m06:17:56.251362 [info ] [MainThread]: 
[0m06:17:56.251641 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:17:56.251880 [info ] [MainThread]: 
[0m06:17:56.252295 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:17:56.255832 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m06:17:56.290176 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m06:17:56.290468 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m06:17:56.290681 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:17:56.296209 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "destination_postgres" (172.18.0.2), port 5432 failed: FATAL:  password authentication failed for user "postgres"

[0m06:17:56.300483 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m06:17:56.300800 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m06:17:56.301109 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m06:17:56.301318 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m06:17:56.301529 [debug] [ThreadPool]: On list_destination_db: No close available on handle
[0m06:17:56.302027 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:17:56.302427 [debug] [MainThread]: Connection 'list_destination_db' was properly closed.
[0m06:17:56.302649 [info ] [MainThread]: 
[0m06:17:56.302903 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.05 seconds (0.05s).
[0m06:17:56.303362 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "destination_postgres" (172.18.0.2), port 5432 failed: FATAL:  password authentication failed for user "postgres"
  
[0m06:17:56.304250 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.8174272, "process_in_blocks": "0", "process_kernel_time": 0.268377, "process_mem_max_rss": "110820", "process_out_blocks": "3480", "process_user_time": 2.659827}
[0m06:17:56.304732 [debug] [MainThread]: Command `dbt run` failed at 06:17:56.304617 after 1.82 seconds
[0m06:17:56.305116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e9c360f080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e9c0f56c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e9c00d7080>]}
[0m06:17:56.305408 [debug] [MainThread]: Flushing usage events
[0m06:17:57.727601 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:18:29.533420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1318d9dd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13193b9730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1318d9d850>]}


============================== 06:18:29.536351 | d06a104e-9bad-4823-ad22-079986cf2a2c ==============================
[0m06:18:29.536351 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:18:29.536741 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:18:29.679318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd06a104e-9bad-4823-ad22-079986cf2a2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1318d9dd30>]}
[0m06:18:29.731569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd06a104e-9bad-4823-ad22-079986cf2a2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1318cf86b0>]}
[0m06:18:29.732152 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:18:29.816434 [debug] [MainThread]: checksum: 568f1e1480817ea4790fb17980df195247d39d7f280a19e6fa3c1e276e1d1417, vars: {}, profile: custom_postgres, target: dev, version: 1.9.0
[0m06:18:29.922391 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:18:29.922690 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:18:29.964203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd06a104e-9bad-4823-ad22-079986cf2a2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1317473650>]}
[0m06:18:30.042331 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m06:18:30.044432 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m06:18:30.058228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd06a104e-9bad-4823-ad22-079986cf2a2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13171a7470>]}
[0m06:18:30.058594 [info ] [MainThread]: Found 4 models, 20 data tests, 3 sources, 429 macros
[0m06:18:30.058858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd06a104e-9bad-4823-ad22-079986cf2a2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f131715cef0>]}
[0m06:18:30.060596 [info ] [MainThread]: 
[0m06:18:30.060873 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:18:30.061157 [info ] [MainThread]: 
[0m06:18:30.061669 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:18:30.065769 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m06:18:30.102533 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m06:18:30.102838 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m06:18:30.103048 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:18:30.110746 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.008 seconds
[0m06:18:30.111876 [debug] [ThreadPool]: On list_destination_db: Close
[0m06:18:30.113413 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_destination_db, now list_destination_db_public)
[0m06:18:30.119372 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m06:18:30.119586 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m06:18:30.119769 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:18:30.124461 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m06:18:30.124792 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m06:18:30.125015 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m06:18:30.127480 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m06:18:30.128589 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m06:18:30.128863 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m06:18:30.133338 [debug] [MainThread]: Using postgres connection "master"
[0m06:18:30.133611 [debug] [MainThread]: On master: BEGIN
[0m06:18:30.133836 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:18:30.138654 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m06:18:30.138987 [debug] [MainThread]: Using postgres connection "master"
[0m06:18:30.139293 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:18:30.142057 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m06:18:30.143243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd06a104e-9bad-4823-ad22-079986cf2a2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13171a7560>]}
[0m06:18:30.143585 [debug] [MainThread]: On master: ROLLBACK
[0m06:18:30.143865 [debug] [MainThread]: Using postgres connection "master"
[0m06:18:30.144090 [debug] [MainThread]: On master: BEGIN
[0m06:18:30.144415 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:18:30.144635 [debug] [MainThread]: On master: COMMIT
[0m06:18:30.144842 [debug] [MainThread]: Using postgres connection "master"
[0m06:18:30.145054 [debug] [MainThread]: On master: COMMIT
[0m06:18:30.145335 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:18:30.145551 [debug] [MainThread]: On master: Close
[0m06:18:30.147089 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m06:18:30.147460 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m06:18:30.147767 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_destination_db_public, now model.custom_postgres.actors)
[0m06:18:30.148070 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m06:18:30.155525 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m06:18:30.156093 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m06:18:30.186710 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m06:18:30.187286 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:18:30.187531 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m06:18:30.187757 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:18:30.193339 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m06:18:30.193588 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:18:30.193823 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m06:18:30.195101 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.001 seconds
[0m06:18:30.199751 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:18:30.200012 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m06:18:30.200442 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:18:30.202591 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:18:30.202837 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m06:18:30.203196 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:18:30.218970 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m06:18:30.219249 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:18:30.219480 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m06:18:30.220663 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m06:18:30.225179 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."actors__dbt_backup"
[0m06:18:30.229314 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:18:30.229637 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m06:18:30.232308 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m06:18:30.234112 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m06:18:30.235639 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd06a104e-9bad-4823-ad22-079986cf2a2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f131aa7e600>]}
[0m06:18:30.236177 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.09s]
[0m06:18:30.236760 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m06:18:30.237129 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m06:18:30.237522 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m06:18:30.237809 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.actors, now model.custom_postgres.film_actors)
[0m06:18:30.238060 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m06:18:30.239913 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m06:18:30.240337 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m06:18:30.242470 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m06:18:30.242829 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:18:30.243073 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m06:18:30.243297 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:18:30.249148 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m06:18:30.249752 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:18:30.250070 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m06:18:30.251218 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.001 seconds
[0m06:18:30.253607 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:18:30.253870 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m06:18:30.254260 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:18:30.256227 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:18:30.256484 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m06:18:30.256912 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:18:30.259007 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m06:18:30.259278 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:18:30.259514 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m06:18:30.260254 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m06:18:30.262810 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."film_actors__dbt_backup"
[0m06:18:30.263276 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:18:30.263519 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m06:18:30.265057 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m06:18:30.266090 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m06:18:30.266555 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd06a104e-9bad-4823-ad22-079986cf2a2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1314a512e0>]}
[0m06:18:30.267100 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.03s]
[0m06:18:30.267625 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m06:18:30.267970 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m06:18:30.268709 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m06:18:30.269305 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.film_actors, now model.custom_postgres.films)
[0m06:18:30.269773 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m06:18:30.271698 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m06:18:30.272066 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m06:18:30.274245 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m06:18:30.274588 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:18:30.274823 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m06:18:30.275053 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:18:30.281629 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m06:18:30.282040 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:18:30.282290 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m06:18:30.284273 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.002 seconds
[0m06:18:30.286811 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:18:30.287080 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m06:18:30.287621 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:18:30.289451 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:18:30.289695 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m06:18:30.290142 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:18:30.291372 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m06:18:30.291612 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:18:30.291837 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m06:18:30.292626 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m06:18:30.294076 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."films__dbt_backup"
[0m06:18:30.294482 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:18:30.294726 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m06:18:30.296448 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m06:18:30.297388 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m06:18:30.297824 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd06a104e-9bad-4823-ad22-079986cf2a2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13163747d0>]}
[0m06:18:30.298346 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.03s]
[0m06:18:30.298852 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m06:18:30.299638 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m06:18:30.299939 [info ] [Thread-1 (]: 4 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m06:18:30.300237 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.films, now model.custom_postgres.film_ratings)
[0m06:18:30.300493 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m06:18:30.303059 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m06:18:30.303423 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m06:18:30.305666 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m06:18:30.306101 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m06:18:30.306340 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m06:18:30.306563 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:18:30.311576 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m06:18:30.311848 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m06:18:30.312132 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  
  
    as
  
  (
    WITH films_with_ratings AS (
    SELECT
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        CASE
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Good'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END AS rating_category
    FROM "destination_db"."public"."films"
),

films_with_actors AS (
    SELECT
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ', ') AS actors,
    FROM "destination_db"."public"."films" AS f
    LEFT JOIN "destination_db"."public"."actors" AS fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" AS a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title
)

SELECT
    fwf.*,
    fwa.actors
FROM films_with_ratings AS fwf
LEFT JOIN films_with_actors AS fwa ON fwf.film_id = fwa.film_id
  );
  
[0m06:18:30.312850 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "FROM"
LINE 34:     FROM "destination_db"."public"."films" AS f
             ^

[0m06:18:30.313194 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: ROLLBACK
[0m06:18:30.313541 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m06:18:30.316363 [debug] [Thread-1 (]: Database Error in model film_ratings (models/example/film_ratings.sql)
  syntax error at or near "FROM"
  LINE 34:     FROM "destination_db"."public"."films" AS f
               ^
  compiled code at target/run/custom_postgres/models/example/film_ratings.sql
[0m06:18:30.316708 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd06a104e-9bad-4823-ad22-079986cf2a2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1314a4af30>]}
[0m06:18:30.317163 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model public.film_ratings ...................... [[31mERROR[0m in 0.02s]
[0m06:18:30.317586 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m06:18:30.318330 [debug] [Thread-4 (]: Marking all children of 'model.custom_postgres.film_ratings' to be skipped because of status 'error'.  Reason: Database Error in model film_ratings (models/example/film_ratings.sql)
  syntax error at or near "FROM"
  LINE 34:     FROM "destination_db"."public"."films" AS f
               ^
  compiled code at target/run/custom_postgres/models/example/film_ratings.sql.
[0m06:18:30.320543 [debug] [MainThread]: Using postgres connection "master"
[0m06:18:30.320790 [debug] [MainThread]: On master: BEGIN
[0m06:18:30.321006 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:18:30.325940 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m06:18:30.326224 [debug] [MainThread]: On master: COMMIT
[0m06:18:30.326439 [debug] [MainThread]: Using postgres connection "master"
[0m06:18:30.326646 [debug] [MainThread]: On master: COMMIT
[0m06:18:30.326971 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:18:30.327215 [debug] [MainThread]: On master: Close
[0m06:18:30.327588 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:18:30.327858 [debug] [MainThread]: Connection 'model.custom_postgres.film_ratings' was properly closed.
[0m06:18:30.328227 [info ] [MainThread]: 
[0m06:18:30.328543 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m06:18:30.330527 [debug] [MainThread]: Command end result
[0m06:18:30.356165 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m06:18:30.357947 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m06:18:30.365538 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m06:18:30.365757 [info ] [MainThread]: 
[0m06:18:30.366021 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m06:18:30.366278 [info ] [MainThread]: 
[0m06:18:30.366578 [error] [MainThread]:   Database Error in model film_ratings (models/example/film_ratings.sql)
  syntax error at or near "FROM"
  LINE 34:     FROM "destination_db"."public"."films" AS f
               ^
  compiled code at target/run/custom_postgres/models/example/film_ratings.sql
[0m06:18:30.366831 [info ] [MainThread]: 
[0m06:18:30.367117 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m06:18:30.367925 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.91057885, "process_in_blocks": "0", "process_kernel_time": 0.275605, "process_mem_max_rss": "107304", "process_out_blocks": "2040", "process_user_time": 1.634591}
[0m06:18:30.368509 [debug] [MainThread]: Command `dbt run` failed at 06:18:30.368413 after 0.91 seconds
[0m06:18:30.368842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1318dcc410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1318d9d850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13164ade50>]}
[0m06:18:30.369141 [debug] [MainThread]: Flushing usage events
[0m06:18:31.733086 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:18:56.428548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3a9a0cda00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3a9a0cd9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3a9a0ce2a0>]}


============================== 06:18:56.434202 | a023daf8-1fd0-42d7-946f-6f9d3217b3f3 ==============================
[0m06:18:56.434202 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:18:56.434600 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:18:56.613378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a023daf8-1fd0-42d7-946f-6f9d3217b3f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3a9a66bf50>]}
[0m06:18:56.665766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a023daf8-1fd0-42d7-946f-6f9d3217b3f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3a9a54f5c0>]}
[0m06:18:56.666369 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:18:56.752532 [debug] [MainThread]: checksum: 568f1e1480817ea4790fb17980df195247d39d7f280a19e6fa3c1e276e1d1417, vars: {}, profile: custom_postgres, target: dev, version: 1.9.0
[0m06:18:56.860735 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:18:56.861044 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:18:56.903246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a023daf8-1fd0-42d7-946f-6f9d3217b3f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3a9833cf20>]}
[0m06:18:56.982285 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m06:18:56.984458 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m06:18:57.006516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a023daf8-1fd0-42d7-946f-6f9d3217b3f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3a99e269f0>]}
[0m06:18:57.006906 [info ] [MainThread]: Found 4 models, 20 data tests, 3 sources, 429 macros
[0m06:18:57.007175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a023daf8-1fd0-42d7-946f-6f9d3217b3f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3a9803c410>]}
[0m06:18:57.008914 [info ] [MainThread]: 
[0m06:18:57.009209 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:18:57.009445 [info ] [MainThread]: 
[0m06:18:57.009835 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:18:57.013570 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m06:18:57.049716 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m06:18:57.050013 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m06:18:57.050232 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:18:57.060987 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.011 seconds
[0m06:18:57.062161 [debug] [ThreadPool]: On list_destination_db: Close
[0m06:18:57.063588 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_destination_db, now list_destination_db_public)
[0m06:18:57.068388 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m06:18:57.068616 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m06:18:57.068807 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:18:57.073287 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m06:18:57.073553 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m06:18:57.073765 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m06:18:57.076307 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m06:18:57.077296 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m06:18:57.077577 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m06:18:57.081779 [debug] [MainThread]: Using postgres connection "master"
[0m06:18:57.082106 [debug] [MainThread]: On master: BEGIN
[0m06:18:57.082322 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:18:57.087088 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m06:18:57.087444 [debug] [MainThread]: Using postgres connection "master"
[0m06:18:57.087731 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:18:57.090600 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m06:18:57.091793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a023daf8-1fd0-42d7-946f-6f9d3217b3f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3a98301130>]}
[0m06:18:57.092154 [debug] [MainThread]: On master: ROLLBACK
[0m06:18:57.092459 [debug] [MainThread]: Using postgres connection "master"
[0m06:18:57.092694 [debug] [MainThread]: On master: BEGIN
[0m06:18:57.093043 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:18:57.093404 [debug] [MainThread]: On master: COMMIT
[0m06:18:57.093668 [debug] [MainThread]: Using postgres connection "master"
[0m06:18:57.093898 [debug] [MainThread]: On master: COMMIT
[0m06:18:57.094259 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:18:57.094707 [debug] [MainThread]: On master: Close
[0m06:18:57.096475 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m06:18:57.097207 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m06:18:57.097856 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_destination_db_public, now model.custom_postgres.actors)
[0m06:18:57.098385 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m06:18:57.109942 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m06:18:57.110855 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m06:18:57.143661 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m06:18:57.144229 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:18:57.144498 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m06:18:57.144731 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:18:57.151325 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m06:18:57.151721 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:18:57.151972 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m06:18:57.152464 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                           ^

[0m06:18:57.152800 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m06:18:57.153280 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m06:18:57.156793 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/actors.sql
[0m06:18:57.158107 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a023daf8-1fd0-42d7-946f-6f9d3217b3f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3a9a66ad20>]}
[0m06:18:57.158569 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.06s]
[0m06:18:57.159081 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m06:18:57.159375 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m06:18:57.159985 [debug] [Thread-4 (]: Marking all children of 'model.custom_postgres.actors' to be skipped because of status 'error'.  Reason: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/actors.sql.
[0m06:18:57.160519 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m06:18:57.161910 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.actors, now model.custom_postgres.film_actors)
[0m06:18:57.162187 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m06:18:57.164282 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m06:18:57.164700 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m06:18:57.166884 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m06:18:57.167286 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:18:57.167532 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m06:18:57.167778 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:18:57.172401 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m06:18:57.172709 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:18:57.172953 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m06:18:57.173444 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                           ^

[0m06:18:57.173758 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m06:18:57.174144 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m06:18:57.176304 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/film_actors.sql
[0m06:18:57.176699 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a023daf8-1fd0-42d7-946f-6f9d3217b3f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3a97e60b30>]}
[0m06:18:57.177227 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.01s]
[0m06:18:57.177647 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m06:18:57.177917 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m06:18:57.178564 [debug] [Thread-4 (]: Marking all children of 'model.custom_postgres.film_actors' to be skipped because of status 'error'.  Reason: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/film_actors.sql.
[0m06:18:57.179172 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m06:18:57.179834 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.film_actors, now model.custom_postgres.films)
[0m06:18:57.180224 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m06:18:57.183112 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m06:18:57.183726 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m06:18:57.187459 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m06:18:57.187908 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:18:57.188169 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m06:18:57.188401 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:18:57.194151 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m06:18:57.194567 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:18:57.194829 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m06:18:57.195315 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."films"
                           ^

[0m06:18:57.195850 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m06:18:57.196340 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m06:18:57.198686 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled code at target/run/custom_postgres/models/example/films.sql
[0m06:18:57.199067 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a023daf8-1fd0-42d7-946f-6f9d3217b3f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3a970f3f80>]}
[0m06:18:57.199602 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.02s]
[0m06:18:57.200122 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m06:18:57.200588 [debug] [Thread-4 (]: Marking all children of 'model.custom_postgres.films' to be skipped because of status 'error'.  Reason: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled code at target/run/custom_postgres/models/example/films.sql.
[0m06:18:57.201372 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m06:18:57.201654 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m06:18:57.201993 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m06:18:57.202999 [debug] [MainThread]: Using postgres connection "master"
[0m06:18:57.203331 [debug] [MainThread]: On master: BEGIN
[0m06:18:57.203549 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:18:57.208322 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m06:18:57.208629 [debug] [MainThread]: On master: COMMIT
[0m06:18:57.208854 [debug] [MainThread]: Using postgres connection "master"
[0m06:18:57.209083 [debug] [MainThread]: On master: COMMIT
[0m06:18:57.209374 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:18:57.209603 [debug] [MainThread]: On master: Close
[0m06:18:57.209954 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:18:57.210184 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m06:18:57.210510 [info ] [MainThread]: 
[0m06:18:57.210780 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m06:18:57.211753 [debug] [MainThread]: Command end result
[0m06:18:57.249222 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m06:18:57.251364 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m06:18:57.258537 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m06:18:57.258767 [info ] [MainThread]: 
[0m06:18:57.259075 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m06:18:57.259343 [info ] [MainThread]: 
[0m06:18:57.259653 [error] [MainThread]:   Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/actors.sql
[0m06:18:57.259904 [info ] [MainThread]: 
[0m06:18:57.260239 [error] [MainThread]:   Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/film_actors.sql
[0m06:18:57.260532 [info ] [MainThread]: 
[0m06:18:57.260881 [error] [MainThread]:   Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled code at target/run/custom_postgres/models/example/films.sql
[0m06:18:57.261164 [info ] [MainThread]: 
[0m06:18:57.261436 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m06:18:57.262313 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.8745208, "process_in_blocks": "0", "process_kernel_time": 0.265167, "process_mem_max_rss": "107988", "process_out_blocks": "3616", "process_user_time": 1.707638}
[0m06:18:57.262716 [debug] [MainThread]: Command `dbt run` failed at 06:18:57.262631 after 0.88 seconds
[0m06:18:57.263038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3a9b4e6cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3a9a68aff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3a9a1827b0>]}
[0m06:18:57.263337 [debug] [MainThread]: Flushing usage events
[0m06:18:58.314310 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:20:35.969654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b412abd7d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b412a384cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b412a438cb0>]}


============================== 06:20:35.975899 | 1bbffda1-88e6-493c-8185-637d71e82376 ==============================
[0m06:20:35.975899 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:20:35.976302 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'send_anonymous_usage_stats': 'True'}
[0m06:20:36.153620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1bbffda1-88e6-493c-8185-637d71e82376', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4129e8f530>]}
[0m06:20:36.205536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1bbffda1-88e6-493c-8185-637d71e82376', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4129fb8f50>]}
[0m06:20:36.206112 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:20:36.291192 [debug] [MainThread]: checksum: 568f1e1480817ea4790fb17980df195247d39d7f280a19e6fa3c1e276e1d1417, vars: {}, profile: custom_postgres, target: dev, version: 1.9.0
[0m06:20:36.399582 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:20:36.399887 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:20:36.442438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1bbffda1-88e6-493c-8185-637d71e82376', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b41286a5310>]}
[0m06:20:36.522150 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m06:20:36.524368 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m06:20:36.546156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1bbffda1-88e6-493c-8185-637d71e82376', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b41281eb5c0>]}
[0m06:20:36.546530 [info ] [MainThread]: Found 4 models, 20 data tests, 3 sources, 429 macros
[0m06:20:36.546776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1bbffda1-88e6-493c-8185-637d71e82376', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4128463230>]}
[0m06:20:36.548510 [info ] [MainThread]: 
[0m06:20:36.548788 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:20:36.549028 [info ] [MainThread]: 
[0m06:20:36.549453 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:20:36.553310 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m06:20:36.590489 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m06:20:36.590804 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m06:20:36.591006 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:20:36.600290 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.009 seconds
[0m06:20:36.601342 [debug] [ThreadPool]: On list_destination_db: Close
[0m06:20:36.602750 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_destination_db, now list_destination_db_public)
[0m06:20:36.607396 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m06:20:36.607614 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m06:20:36.607798 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:20:36.612409 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m06:20:36.612731 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m06:20:36.612947 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m06:20:36.615440 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m06:20:36.616552 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m06:20:36.616807 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m06:20:36.620374 [debug] [MainThread]: Using postgres connection "master"
[0m06:20:36.620707 [debug] [MainThread]: On master: BEGIN
[0m06:20:36.620915 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:20:36.627058 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m06:20:36.627638 [debug] [MainThread]: Using postgres connection "master"
[0m06:20:36.628307 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:20:36.632610 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m06:20:36.635353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1bbffda1-88e6-493c-8185-637d71e82376', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4129e8f650>]}
[0m06:20:36.636075 [debug] [MainThread]: On master: ROLLBACK
[0m06:20:36.636693 [debug] [MainThread]: Using postgres connection "master"
[0m06:20:36.637212 [debug] [MainThread]: On master: BEGIN
[0m06:20:36.637900 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:20:36.638426 [debug] [MainThread]: On master: COMMIT
[0m06:20:36.638904 [debug] [MainThread]: Using postgres connection "master"
[0m06:20:36.639397 [debug] [MainThread]: On master: COMMIT
[0m06:20:36.639982 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:20:36.640502 [debug] [MainThread]: On master: Close
[0m06:20:36.643173 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m06:20:36.644000 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m06:20:36.644657 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_destination_db_public, now model.custom_postgres.actors)
[0m06:20:36.645218 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m06:20:36.650874 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m06:20:36.651355 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m06:20:36.682556 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m06:20:36.683164 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:20:36.683424 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m06:20:36.683653 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:20:36.688729 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m06:20:36.689043 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:20:36.689294 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m06:20:36.689744 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                           ^

[0m06:20:36.690054 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m06:20:36.690754 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m06:20:36.693616 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/actors.sql
[0m06:20:36.695041 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1bbffda1-88e6-493c-8185-637d71e82376', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b412aa12450>]}
[0m06:20:36.695541 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.05s]
[0m06:20:36.696003 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m06:20:36.696309 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m06:20:36.696942 [debug] [Thread-4 (]: Marking all children of 'model.custom_postgres.actors' to be skipped because of status 'error'.  Reason: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/actors.sql.
[0m06:20:36.697515 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m06:20:36.698540 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.actors, now model.custom_postgres.film_actors)
[0m06:20:36.698794 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m06:20:36.700851 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m06:20:36.701291 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m06:20:36.703381 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m06:20:36.703771 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:20:36.704019 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m06:20:36.704262 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:20:36.709660 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m06:20:36.710269 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:20:36.710520 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m06:20:36.710988 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                           ^

[0m06:20:36.711266 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m06:20:36.711716 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m06:20:36.713938 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/film_actors.sql
[0m06:20:36.714350 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1bbffda1-88e6-493c-8185-637d71e82376', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b41284446b0>]}
[0m06:20:36.714801 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.02s]
[0m06:20:36.715285 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m06:20:36.715567 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m06:20:36.716218 [debug] [Thread-4 (]: Marking all children of 'model.custom_postgres.film_actors' to be skipped because of status 'error'.  Reason: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/film_actors.sql.
[0m06:20:36.716754 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m06:20:36.717374 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.film_actors, now model.custom_postgres.films)
[0m06:20:36.717620 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m06:20:36.719689 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m06:20:36.720155 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m06:20:36.722315 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m06:20:36.722710 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:20:36.722946 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m06:20:36.723198 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:20:36.728065 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m06:20:36.728368 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:20:36.728634 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m06:20:36.729089 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."films"
                           ^

[0m06:20:36.729464 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m06:20:36.729829 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m06:20:36.731978 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled code at target/run/custom_postgres/models/example/films.sql
[0m06:20:36.732363 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1bbffda1-88e6-493c-8185-637d71e82376', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b41274f9d30>]}
[0m06:20:36.732839 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.01s]
[0m06:20:36.733307 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m06:20:36.733962 [debug] [Thread-4 (]: Marking all children of 'model.custom_postgres.films' to be skipped because of status 'error'.  Reason: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled code at target/run/custom_postgres/models/example/films.sql.
[0m06:20:36.734978 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m06:20:36.735379 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m06:20:36.735756 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m06:20:36.736774 [debug] [MainThread]: Using postgres connection "master"
[0m06:20:36.737015 [debug] [MainThread]: On master: BEGIN
[0m06:20:36.737240 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:20:36.741584 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m06:20:36.741906 [debug] [MainThread]: On master: COMMIT
[0m06:20:36.742143 [debug] [MainThread]: Using postgres connection "master"
[0m06:20:36.742355 [debug] [MainThread]: On master: COMMIT
[0m06:20:36.742643 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:20:36.742865 [debug] [MainThread]: On master: Close
[0m06:20:36.743187 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:20:36.743400 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m06:20:36.743677 [info ] [MainThread]: 
[0m06:20:36.743941 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m06:20:36.744917 [debug] [MainThread]: Command end result
[0m06:20:36.770454 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m06:20:36.771655 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m06:20:36.776688 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m06:20:36.776910 [info ] [MainThread]: 
[0m06:20:36.777198 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m06:20:36.777461 [info ] [MainThread]: 
[0m06:20:36.777822 [error] [MainThread]:   Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/actors.sql
[0m06:20:36.778138 [info ] [MainThread]: 
[0m06:20:36.778464 [error] [MainThread]:   Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/film_actors.sql
[0m06:20:36.778740 [info ] [MainThread]: 
[0m06:20:36.779118 [error] [MainThread]:   Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled code at target/run/custom_postgres/models/example/films.sql
[0m06:20:36.779430 [info ] [MainThread]: 
[0m06:20:36.779783 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m06:20:36.780720 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.8513311, "process_in_blocks": "0", "process_kernel_time": 0.261135, "process_mem_max_rss": "108148", "process_out_blocks": "3608", "process_user_time": 1.679873}
[0m06:20:36.781149 [debug] [MainThread]: Command `dbt run` failed at 06:20:36.781060 after 0.85 seconds
[0m06:20:36.781458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4129fbaa80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b412a4d84a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b412a4d9b50>]}
[0m06:20:36.781761 [debug] [MainThread]: Flushing usage events
[0m06:20:38.134941 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:23:24.225955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f238f055b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f238f05520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f238f043b0>]}


============================== 06:23:24.231230 | 086de6ee-1a34-4595-b3ce-0f1f565a12f3 ==============================
[0m06:23:24.231230 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:23:24.231629 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:23:24.423837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '086de6ee-1a34-4595-b3ce-0f1f565a12f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f2375b81d0>]}
[0m06:23:24.478025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '086de6ee-1a34-4595-b3ce-0f1f565a12f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f23958db20>]}
[0m06:23:24.478762 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:23:24.567732 [debug] [MainThread]: checksum: 568f1e1480817ea4790fb17980df195247d39d7f280a19e6fa3c1e276e1d1417, vars: {}, profile: custom_postgres, target: dev, version: 1.9.0
[0m06:23:24.678326 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:23:24.678633 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:23:24.721444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '086de6ee-1a34-4595-b3ce-0f1f565a12f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f237675a90>]}
[0m06:23:24.801109 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m06:23:24.803243 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m06:23:24.825293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '086de6ee-1a34-4595-b3ce-0f1f565a12f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f23749f3b0>]}
[0m06:23:24.825679 [info ] [MainThread]: Found 4 models, 20 data tests, 3 sources, 429 macros
[0m06:23:24.825926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '086de6ee-1a34-4595-b3ce-0f1f565a12f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f2376776e0>]}
[0m06:23:24.827731 [info ] [MainThread]: 
[0m06:23:24.828007 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:23:24.828287 [info ] [MainThread]: 
[0m06:23:24.828778 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:23:24.832654 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m06:23:24.869891 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m06:23:24.870203 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m06:23:24.870401 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:23:24.879806 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.009 seconds
[0m06:23:24.880972 [debug] [ThreadPool]: On list_destination_db: Close
[0m06:23:24.882283 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_destination_db, now list_destination_db_public)
[0m06:23:24.888743 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m06:23:24.888969 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m06:23:24.889173 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:23:24.893888 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m06:23:24.894179 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m06:23:24.894410 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m06:23:24.896909 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m06:23:24.898051 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m06:23:24.898394 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m06:23:24.902371 [debug] [MainThread]: Using postgres connection "master"
[0m06:23:24.902703 [debug] [MainThread]: On master: BEGIN
[0m06:23:24.902918 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:23:24.907381 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m06:23:24.907770 [debug] [MainThread]: Using postgres connection "master"
[0m06:23:24.908078 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:23:24.911653 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m06:23:24.912860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '086de6ee-1a34-4595-b3ce-0f1f565a12f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f237461580>]}
[0m06:23:24.913226 [debug] [MainThread]: On master: ROLLBACK
[0m06:23:24.913515 [debug] [MainThread]: Using postgres connection "master"
[0m06:23:24.913735 [debug] [MainThread]: On master: BEGIN
[0m06:23:24.914059 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:23:24.914359 [debug] [MainThread]: On master: COMMIT
[0m06:23:24.914594 [debug] [MainThread]: Using postgres connection "master"
[0m06:23:24.914805 [debug] [MainThread]: On master: COMMIT
[0m06:23:24.915082 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:23:24.915326 [debug] [MainThread]: On master: Close
[0m06:23:24.916832 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m06:23:24.917514 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m06:23:24.917904 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_destination_db_public, now model.custom_postgres.actors)
[0m06:23:24.918230 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m06:23:24.924150 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m06:23:24.924642 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m06:23:24.955930 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m06:23:24.956457 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:23:24.956707 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m06:23:24.956933 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:23:24.963334 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m06:23:24.963899 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:23:24.964337 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m06:23:24.964874 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                           ^

[0m06:23:24.965190 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m06:23:24.965577 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m06:23:24.969509 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/actors.sql
[0m06:23:24.970837 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '086de6ee-1a34-4595-b3ce-0f1f565a12f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f23737a8d0>]}
[0m06:23:24.971322 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.05s]
[0m06:23:24.971789 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m06:23:24.972082 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m06:23:24.972761 [debug] [Thread-4 (]: Marking all children of 'model.custom_postgres.actors' to be skipped because of status 'error'.  Reason: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/actors.sql.
[0m06:23:24.973307 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m06:23:24.974862 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.actors, now model.custom_postgres.film_actors)
[0m06:23:24.975122 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m06:23:24.977367 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m06:23:24.977790 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m06:23:24.979978 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m06:23:24.980432 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:23:24.980695 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m06:23:24.980928 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:23:24.986917 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m06:23:24.987362 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:23:24.987602 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m06:23:24.988064 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                           ^

[0m06:23:24.988411 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m06:23:24.988815 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m06:23:24.990983 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/film_actors.sql
[0m06:23:24.991500 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '086de6ee-1a34-4595-b3ce-0f1f565a12f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f2371d1070>]}
[0m06:23:24.992162 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.02s]
[0m06:23:24.992759 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m06:23:24.993131 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m06:23:24.993497 [debug] [Thread-4 (]: Marking all children of 'model.custom_postgres.film_actors' to be skipped because of status 'error'.  Reason: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/film_actors.sql.
[0m06:23:24.993888 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m06:23:24.994390 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.film_actors, now model.custom_postgres.films)
[0m06:23:24.994633 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m06:23:24.996675 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m06:23:24.997114 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m06:23:24.999355 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m06:23:25.000110 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:23:25.000604 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m06:23:25.001089 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:23:25.006141 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m06:23:25.006489 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:23:25.006734 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m06:23:25.007172 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."films"
                           ^

[0m06:23:25.007645 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m06:23:25.008060 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m06:23:25.010240 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled code at target/run/custom_postgres/models/example/films.sql
[0m06:23:25.010697 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '086de6ee-1a34-4595-b3ce-0f1f565a12f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f236457b00>]}
[0m06:23:25.011176 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.02s]
[0m06:23:25.011597 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m06:23:25.012212 [debug] [Thread-4 (]: Marking all children of 'model.custom_postgres.films' to be skipped because of status 'error'.  Reason: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled code at target/run/custom_postgres/models/example/films.sql.
[0m06:23:25.013108 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m06:23:25.013414 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m06:23:25.013746 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m06:23:25.014694 [debug] [MainThread]: Using postgres connection "master"
[0m06:23:25.014945 [debug] [MainThread]: On master: BEGIN
[0m06:23:25.015181 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:23:25.021553 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m06:23:25.022193 [debug] [MainThread]: On master: COMMIT
[0m06:23:25.022622 [debug] [MainThread]: Using postgres connection "master"
[0m06:23:25.023053 [debug] [MainThread]: On master: COMMIT
[0m06:23:25.023580 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:23:25.024006 [debug] [MainThread]: On master: Close
[0m06:23:25.024641 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:23:25.025044 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m06:23:25.025560 [info ] [MainThread]: 
[0m06:23:25.026048 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m06:23:25.027971 [debug] [MainThread]: Command end result
[0m06:23:25.066903 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m06:23:25.068770 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m06:23:25.074242 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m06:23:25.074465 [info ] [MainThread]: 
[0m06:23:25.074749 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m06:23:25.075025 [info ] [MainThread]: 
[0m06:23:25.075442 [error] [MainThread]:   Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/actors.sql
[0m06:23:25.075738 [info ] [MainThread]: 
[0m06:23:25.076095 [error] [MainThread]:   Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/film_actors.sql
[0m06:23:25.076382 [info ] [MainThread]: 
[0m06:23:25.076711 [error] [MainThread]:   Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled code at target/run/custom_postgres/models/example/films.sql
[0m06:23:25.077010 [info ] [MainThread]: 
[0m06:23:25.077393 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m06:23:25.078430 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.8926004, "process_in_blocks": "0", "process_kernel_time": 0.30077, "process_mem_max_rss": "108284", "process_out_blocks": "3608", "process_user_time": 1.73268}
[0m06:23:25.078976 [debug] [MainThread]: Command `dbt run` failed at 06:23:25.078854 after 0.89 seconds
[0m06:23:25.079401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f2391358e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f238daf0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f2395b9280>]}
[0m06:23:25.079800 [debug] [MainThread]: Flushing usage events
[0m06:23:26.203303 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:23:46.339374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c927aa3980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c928ef6b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c927b6abd0>]}


============================== 06:23:46.342744 | 4304173e-a9d9-416a-9c14-305f2c3381e5 ==============================
[0m06:23:46.342744 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:23:46.343156 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root', 'version_check': 'True', 'debug': 'False', 'log_path': '/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:23:46.496898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4304173e-a9d9-416a-9c14-305f2c3381e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c92790ca70>]}
[0m06:23:46.549502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4304173e-a9d9-416a-9c14-305f2c3381e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c92790e300>]}
[0m06:23:46.550083 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:23:46.635968 [debug] [MainThread]: checksum: 568f1e1480817ea4790fb17980df195247d39d7f280a19e6fa3c1e276e1d1417, vars: {}, profile: custom_postgres, target: dev, version: 1.9.0
[0m06:23:46.743590 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:23:46.743893 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:23:46.785928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4304173e-a9d9-416a-9c14-305f2c3381e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c9261644a0>]}
[0m06:23:46.867239 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m06:23:46.869407 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m06:23:46.883388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4304173e-a9d9-416a-9c14-305f2c3381e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c925ec3770>]}
[0m06:23:46.883767 [info ] [MainThread]: Found 4 models, 20 data tests, 3 sources, 429 macros
[0m06:23:46.884047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4304173e-a9d9-416a-9c14-305f2c3381e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c926181910>]}
[0m06:23:46.885876 [info ] [MainThread]: 
[0m06:23:46.886154 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:23:46.886475 [info ] [MainThread]: 
[0m06:23:46.886952 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:23:46.890572 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m06:23:46.926004 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m06:23:46.926302 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m06:23:46.926505 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:23:46.933626 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.007 seconds
[0m06:23:46.934788 [debug] [ThreadPool]: On list_destination_db: Close
[0m06:23:46.936085 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_destination_db, now list_destination_db_public)
[0m06:23:46.941098 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m06:23:46.941318 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m06:23:46.941517 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:23:46.945711 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m06:23:46.945986 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m06:23:46.946219 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m06:23:46.948678 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m06:23:46.949757 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m06:23:46.950023 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m06:23:46.954220 [debug] [MainThread]: Using postgres connection "master"
[0m06:23:46.954476 [debug] [MainThread]: On master: BEGIN
[0m06:23:46.954679 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:23:46.959253 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m06:23:46.959763 [debug] [MainThread]: Using postgres connection "master"
[0m06:23:46.960210 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:23:46.963028 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m06:23:46.964185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4304173e-a9d9-416a-9c14-305f2c3381e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c927956a20>]}
[0m06:23:46.964522 [debug] [MainThread]: On master: ROLLBACK
[0m06:23:46.964820 [debug] [MainThread]: Using postgres connection "master"
[0m06:23:46.965041 [debug] [MainThread]: On master: BEGIN
[0m06:23:46.965375 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:23:46.965652 [debug] [MainThread]: On master: COMMIT
[0m06:23:46.965868 [debug] [MainThread]: Using postgres connection "master"
[0m06:23:46.966103 [debug] [MainThread]: On master: COMMIT
[0m06:23:46.966378 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:23:46.966603 [debug] [MainThread]: On master: Close
[0m06:23:46.968230 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m06:23:46.968798 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m06:23:46.969147 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_destination_db_public, now model.custom_postgres.actors)
[0m06:23:46.969395 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m06:23:46.976093 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m06:23:46.977012 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m06:23:47.007877 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m06:23:47.008378 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:23:47.008621 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m06:23:47.008845 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:23:47.014057 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m06:23:47.014333 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:23:47.014577 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m06:23:47.015804 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.001 seconds
[0m06:23:47.020688 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:23:47.020961 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m06:23:47.021396 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:23:47.023324 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:23:47.023570 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m06:23:47.023935 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:23:47.039182 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m06:23:47.039446 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:23:47.039673 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m06:23:47.040582 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m06:23:47.045000 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."actors__dbt_backup"
[0m06:23:47.049157 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:23:47.049409 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m06:23:47.052066 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m06:23:47.053861 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m06:23:47.055054 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4304173e-a9d9-416a-9c14-305f2c3381e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c925067f80>]}
[0m06:23:47.055495 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.09s]
[0m06:23:47.055897 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m06:23:47.056175 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m06:23:47.056568 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m06:23:47.056871 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.actors, now model.custom_postgres.film_actors)
[0m06:23:47.057125 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m06:23:47.059377 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m06:23:47.059886 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m06:23:47.062280 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m06:23:47.062700 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:23:47.062936 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m06:23:47.063194 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:23:47.068641 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m06:23:47.069013 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:23:47.069291 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m06:23:47.070433 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.001 seconds
[0m06:23:47.072729 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:23:47.072978 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m06:23:47.073469 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:23:47.075796 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:23:47.076056 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m06:23:47.076417 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:23:47.077521 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m06:23:47.077760 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:23:47.077984 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m06:23:47.078681 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m06:23:47.081117 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."film_actors__dbt_backup"
[0m06:23:47.081543 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:23:47.081783 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m06:23:47.083315 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m06:23:47.084381 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m06:23:47.084838 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4304173e-a9d9-416a-9c14-305f2c3381e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c924f6ddc0>]}
[0m06:23:47.085373 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.03s]
[0m06:23:47.085878 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m06:23:47.086213 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m06:23:47.086689 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m06:23:47.087040 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.film_actors, now model.custom_postgres.films)
[0m06:23:47.087342 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m06:23:47.089305 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m06:23:47.089831 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m06:23:47.092052 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m06:23:47.092431 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:23:47.092666 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m06:23:47.092886 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:23:47.098636 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m06:23:47.098969 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:23:47.099222 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m06:23:47.100435 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.001 seconds
[0m06:23:47.102678 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:23:47.102922 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m06:23:47.103376 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:23:47.105170 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:23:47.105413 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m06:23:47.105760 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:23:47.106958 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m06:23:47.107204 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:23:47.107438 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m06:23:47.108181 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m06:23:47.109721 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."films__dbt_backup"
[0m06:23:47.110152 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:23:47.110400 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m06:23:47.112162 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m06:23:47.113234 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m06:23:47.113639 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4304173e-a9d9-416a-9c14-305f2c3381e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c924f459d0>]}
[0m06:23:47.114076 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.03s]
[0m06:23:47.114500 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m06:23:47.115206 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m06:23:47.115576 [info ] [Thread-1 (]: 4 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m06:23:47.115922 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.films, now model.custom_postgres.film_ratings)
[0m06:23:47.116212 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m06:23:47.118909 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m06:23:47.119390 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m06:23:47.121797 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m06:23:47.122245 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m06:23:47.122488 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m06:23:47.122710 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:23:47.128220 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m06:23:47.128615 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m06:23:47.128883 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  
  
    as
  
  (
    WITH films_with_ratings AS (
    SELECT
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        CASE
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Good'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END AS rating_category
    FROM "destination_db"."public"."films"
),

films_with_actors AS (
    SELECT
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ', ') AS actors,
    FROM "destination_db"."public"."films" AS f
    LEFT JOIN "destination_db"."public"."actors" AS fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" AS a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title
)

SELECT
    fwf.*,
    fwa.actors
FROM films_with_ratings AS fwf
LEFT JOIN films_with_actors AS fwa ON fwf.film_id = fwa.film_id
  );
  
[0m06:23:47.129410 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "FROM"
LINE 34:     FROM "destination_db"."public"."films" AS f
             ^

[0m06:23:47.129735 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: ROLLBACK
[0m06:23:47.130235 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m06:23:47.133886 [debug] [Thread-1 (]: Database Error in model film_ratings (models/example/film_ratings.sql)
  syntax error at or near "FROM"
  LINE 34:     FROM "destination_db"."public"."films" AS f
               ^
  compiled code at target/run/custom_postgres/models/example/film_ratings.sql
[0m06:23:47.134364 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4304173e-a9d9-416a-9c14-305f2c3381e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c925ebb290>]}
[0m06:23:47.134946 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model public.film_ratings ...................... [[31mERROR[0m in 0.02s]
[0m06:23:47.135575 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m06:23:47.136355 [debug] [Thread-4 (]: Marking all children of 'model.custom_postgres.film_ratings' to be skipped because of status 'error'.  Reason: Database Error in model film_ratings (models/example/film_ratings.sql)
  syntax error at or near "FROM"
  LINE 34:     FROM "destination_db"."public"."films" AS f
               ^
  compiled code at target/run/custom_postgres/models/example/film_ratings.sql.
[0m06:23:47.139100 [debug] [MainThread]: Using postgres connection "master"
[0m06:23:47.139683 [debug] [MainThread]: On master: BEGIN
[0m06:23:47.140177 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:23:47.145678 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m06:23:47.146075 [debug] [MainThread]: On master: COMMIT
[0m06:23:47.146570 [debug] [MainThread]: Using postgres connection "master"
[0m06:23:47.147091 [debug] [MainThread]: On master: COMMIT
[0m06:23:47.147667 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:23:47.148184 [debug] [MainThread]: On master: Close
[0m06:23:47.148885 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:23:47.149183 [debug] [MainThread]: Connection 'model.custom_postgres.film_ratings' was properly closed.
[0m06:23:47.149487 [info ] [MainThread]: 
[0m06:23:47.149763 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m06:23:47.151743 [debug] [MainThread]: Command end result
[0m06:23:47.180806 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m06:23:47.182407 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m06:23:47.187900 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m06:23:47.188154 [info ] [MainThread]: 
[0m06:23:47.188421 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m06:23:47.188750 [info ] [MainThread]: 
[0m06:23:47.189049 [error] [MainThread]:   Database Error in model film_ratings (models/example/film_ratings.sql)
  syntax error at or near "FROM"
  LINE 34:     FROM "destination_db"."public"."films" AS f
               ^
  compiled code at target/run/custom_postgres/models/example/film_ratings.sql
[0m06:23:47.189297 [info ] [MainThread]: 
[0m06:23:47.189562 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m06:23:47.190426 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.9245412, "process_in_blocks": "0", "process_kernel_time": 0.275133, "process_mem_max_rss": "107280", "process_out_blocks": "2040", "process_user_time": 1.633793}
[0m06:23:47.190820 [debug] [MainThread]: Command `dbt run` failed at 06:23:47.190735 after 0.93 seconds
[0m06:23:47.191148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c927a70890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c9279e5af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c9251e5b20>]}
[0m06:23:47.191514 [debug] [MainThread]: Flushing usage events
[0m06:23:48.553316 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:24:48.635054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7450383e4b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7450367ad130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7450365e8cb0>]}


============================== 06:24:48.637825 | aaaeeff8-30df-4183-bec7-95a837c81ccd ==============================
[0m06:24:48.637825 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:24:48.638229 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/root', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:24:48.781066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aaaeeff8-30df-4183-bec7-95a837c81ccd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745034c94710>]}
[0m06:24:48.832926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aaaeeff8-30df-4183-bec7-95a837c81ccd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7450364ac080>]}
[0m06:24:48.833519 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:24:48.918896 [debug] [MainThread]: checksum: 568f1e1480817ea4790fb17980df195247d39d7f280a19e6fa3c1e276e1d1417, vars: {}, profile: custom_postgres, target: dev, version: 1.9.0
[0m06:24:49.026787 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:24:49.027373 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://models/example/film_ratings.sql
[0m06:24:49.416463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aaaeeff8-30df-4183-bec7-95a837c81ccd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74502ef4e8d0>]}
[0m06:24:49.492522 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m06:24:49.494638 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m06:24:49.508752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aaaeeff8-30df-4183-bec7-95a837c81ccd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74502ee13c80>]}
[0m06:24:49.509133 [info ] [MainThread]: Found 4 models, 20 data tests, 3 sources, 429 macros
[0m06:24:49.509411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aaaeeff8-30df-4183-bec7-95a837c81ccd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74502ef7f920>]}
[0m06:24:49.511237 [info ] [MainThread]: 
[0m06:24:49.511513 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:24:49.511834 [info ] [MainThread]: 
[0m06:24:49.512378 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:24:49.516229 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m06:24:49.553440 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m06:24:49.553744 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m06:24:49.553944 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:24:49.562194 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.008 seconds
[0m06:24:49.563920 [debug] [ThreadPool]: On list_destination_db: Close
[0m06:24:49.565293 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_destination_db, now list_destination_db_public)
[0m06:24:49.569794 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m06:24:49.570012 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m06:24:49.570260 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:24:49.574749 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m06:24:49.575002 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m06:24:49.575224 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m06:24:49.577709 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m06:24:49.578829 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m06:24:49.579101 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m06:24:49.583748 [debug] [MainThread]: Using postgres connection "master"
[0m06:24:49.584003 [debug] [MainThread]: On master: BEGIN
[0m06:24:49.584229 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:24:49.589107 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m06:24:49.589360 [debug] [MainThread]: Using postgres connection "master"
[0m06:24:49.589641 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:24:49.592458 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m06:24:49.593672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aaaeeff8-30df-4183-bec7-95a837c81ccd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7450348c2780>]}
[0m06:24:49.594007 [debug] [MainThread]: On master: ROLLBACK
[0m06:24:49.594313 [debug] [MainThread]: Using postgres connection "master"
[0m06:24:49.594525 [debug] [MainThread]: On master: BEGIN
[0m06:24:49.594828 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:24:49.595130 [debug] [MainThread]: On master: COMMIT
[0m06:24:49.595376 [debug] [MainThread]: Using postgres connection "master"
[0m06:24:49.595578 [debug] [MainThread]: On master: COMMIT
[0m06:24:49.595838 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:24:49.596062 [debug] [MainThread]: On master: Close
[0m06:24:49.597554 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m06:24:49.598244 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m06:24:49.598602 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_destination_db_public, now model.custom_postgres.actors)
[0m06:24:49.598852 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m06:24:49.605084 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m06:24:49.605603 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m06:24:49.637097 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m06:24:49.637612 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:24:49.637853 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m06:24:49.638084 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:24:49.643643 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m06:24:49.643951 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:24:49.644202 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m06:24:49.645369 [debug] [Thread-1 (]: SQL status: SELECT 40 in 0.001 seconds
[0m06:24:49.650303 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:24:49.650579 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m06:24:49.651046 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:24:49.653218 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:24:49.653481 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m06:24:49.654073 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:24:49.670427 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m06:24:49.670769 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:24:49.670997 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m06:24:49.671876 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m06:24:49.676529 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."actors__dbt_backup"
[0m06:24:49.680662 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:24:49.680910 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m06:24:49.682715 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m06:24:49.684614 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m06:24:49.685801 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aaaeeff8-30df-4183-bec7-95a837c81ccd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74502e1e8380>]}
[0m06:24:49.686250 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 40[0m in 0.09s]
[0m06:24:49.686711 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m06:24:49.686996 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m06:24:49.687447 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m06:24:49.687776 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.actors, now model.custom_postgres.film_actors)
[0m06:24:49.688093 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m06:24:49.690052 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m06:24:49.690456 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m06:24:49.692670 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m06:24:49.693162 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:24:49.693434 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m06:24:49.693665 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:24:49.699837 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m06:24:49.700318 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:24:49.700562 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m06:24:49.701957 [debug] [Thread-1 (]: SQL status: SELECT 40 in 0.001 seconds
[0m06:24:49.704301 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:24:49.704548 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m06:24:49.704968 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:24:49.706836 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:24:49.707095 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m06:24:49.707491 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:24:49.708611 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m06:24:49.708848 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:24:49.709077 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m06:24:49.709778 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m06:24:49.711214 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."film_actors__dbt_backup"
[0m06:24:49.711620 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:24:49.711863 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m06:24:49.713161 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m06:24:49.714088 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m06:24:49.714480 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aaaeeff8-30df-4183-bec7-95a837c81ccd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74502e0b8800>]}
[0m06:24:49.714887 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 40[0m in 0.03s]
[0m06:24:49.715329 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m06:24:49.715651 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m06:24:49.716050 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m06:24:49.716334 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.film_actors, now model.custom_postgres.films)
[0m06:24:49.716600 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m06:24:49.719445 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m06:24:49.719862 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m06:24:49.721991 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m06:24:49.722401 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:24:49.722636 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m06:24:49.722858 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:24:49.728562 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m06:24:49.728908 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:24:49.729172 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m06:24:49.730266 [debug] [Thread-1 (]: SQL status: SELECT 40 in 0.001 seconds
[0m06:24:49.732595 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:24:49.732848 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m06:24:49.733246 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:24:49.735264 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:24:49.735520 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m06:24:49.735893 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:24:49.737001 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m06:24:49.737258 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:24:49.737549 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m06:24:49.738221 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m06:24:49.739591 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."films__dbt_backup"
[0m06:24:49.740053 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:24:49.740293 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m06:24:49.741597 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m06:24:49.742520 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m06:24:49.742915 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aaaeeff8-30df-4183-bec7-95a837c81ccd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74502e0b8800>]}
[0m06:24:49.743335 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.films ................................. [[32mSELECT 40[0m in 0.03s]
[0m06:24:49.743799 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m06:24:49.744538 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m06:24:49.744839 [info ] [Thread-1 (]: 4 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m06:24:49.745163 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.films, now model.custom_postgres.film_ratings)
[0m06:24:49.745513 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m06:24:49.749869 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m06:24:49.750399 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m06:24:49.752615 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m06:24:49.753002 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m06:24:49.753253 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m06:24:49.753478 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:24:49.758415 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m06:24:49.758747 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m06:24:49.759009 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  
  
    as
  
  (
    WITH films_with_ratings AS (
    SELECT
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        CASE
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Good'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END AS rating_category
    FROM "destination_db"."public"."films"
),

films_with_actors AS (
    SELECT
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ', ') AS actors
    FROM "destination_db"."public"."films" AS f
    LEFT JOIN "destination_db"."public"."actors" AS fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" AS a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title
)

SELECT
    fwf.*,
    fwa.actors
FROM films_with_ratings AS fwf
LEFT JOIN films_with_actors AS fwa ON fwf.film_id = fwa.film_id
  );
  
[0m06:24:49.759858 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column fa.film_id does not exist
LINE 35: ...nation_db"."public"."actors" AS fa ON f.film_id = fa.film_id
                                                              ^
HINT:  Perhaps you meant to reference the column "f.film_id".

[0m06:24:49.760191 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: ROLLBACK
[0m06:24:49.760615 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m06:24:49.763406 [debug] [Thread-1 (]: Database Error in model film_ratings (models/example/film_ratings.sql)
  column fa.film_id does not exist
  LINE 35: ...nation_db"."public"."actors" AS fa ON f.film_id = fa.film_id
                                                                ^
  HINT:  Perhaps you meant to reference the column "f.film_id".
  compiled code at target/run/custom_postgres/models/example/film_ratings.sql
[0m06:24:49.763789 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aaaeeff8-30df-4183-bec7-95a837c81ccd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74502e0e9400>]}
[0m06:24:49.764265 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model public.film_ratings ...................... [[31mERROR[0m in 0.02s]
[0m06:24:49.764698 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m06:24:49.765334 [debug] [Thread-4 (]: Marking all children of 'model.custom_postgres.film_ratings' to be skipped because of status 'error'.  Reason: Database Error in model film_ratings (models/example/film_ratings.sql)
  column fa.film_id does not exist
  LINE 35: ...nation_db"."public"."actors" AS fa ON f.film_id = fa.film_id
                                                                ^
  HINT:  Perhaps you meant to reference the column "f.film_id".
  compiled code at target/run/custom_postgres/models/example/film_ratings.sql.
[0m06:24:49.767392 [debug] [MainThread]: Using postgres connection "master"
[0m06:24:49.767757 [debug] [MainThread]: On master: BEGIN
[0m06:24:49.768072 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:24:49.773901 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m06:24:49.774424 [debug] [MainThread]: On master: COMMIT
[0m06:24:49.774740 [debug] [MainThread]: Using postgres connection "master"
[0m06:24:49.775040 [debug] [MainThread]: On master: COMMIT
[0m06:24:49.775501 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:24:49.775808 [debug] [MainThread]: On master: Close
[0m06:24:49.776226 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:24:49.776445 [debug] [MainThread]: Connection 'model.custom_postgres.film_ratings' was properly closed.
[0m06:24:49.776777 [info ] [MainThread]: 
[0m06:24:49.777059 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m06:24:49.778167 [debug] [MainThread]: Command end result
[0m06:24:49.800236 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m06:24:49.801711 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m06:24:49.806879 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m06:24:49.807125 [info ] [MainThread]: 
[0m06:24:49.807402 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m06:24:49.807657 [info ] [MainThread]: 
[0m06:24:49.807984 [error] [MainThread]:   Database Error in model film_ratings (models/example/film_ratings.sql)
  column fa.film_id does not exist
  LINE 35: ...nation_db"."public"."actors" AS fa ON f.film_id = fa.film_id
                                                                ^
  HINT:  Perhaps you meant to reference the column "f.film_id".
  compiled code at target/run/custom_postgres/models/example/film_ratings.sql
[0m06:24:49.808276 [info ] [MainThread]: 
[0m06:24:49.808544 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m06:24:49.809391 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.2474248, "process_in_blocks": "0", "process_kernel_time": 0.268963, "process_mem_max_rss": "112936", "process_out_blocks": "2928", "process_user_time": 1.982732}
[0m06:24:49.809846 [debug] [MainThread]: Command `dbt run` failed at 06:24:49.809760 after 1.25 seconds
[0m06:24:49.810171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745036a64a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745036b0a9c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74502e113ef0>]}
[0m06:24:49.810450 [debug] [MainThread]: Flushing usage events
[0m06:24:51.157212 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:25:24.308337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac889f2d070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac889884bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac88bfb1ca0>]}


============================== 06:25:24.313434 | acdc9753-e8f7-4628-96ce-0d03de6e958b ==============================
[0m06:25:24.313434 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:25:24.313816 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root', 'debug': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'send_anonymous_usage_stats': 'True'}
[0m06:25:24.493763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'acdc9753-e8f7-4628-96ce-0d03de6e958b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac88939fe90>]}
[0m06:25:24.546091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'acdc9753-e8f7-4628-96ce-0d03de6e958b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac889e69790>]}
[0m06:25:24.546668 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:25:24.632646 [debug] [MainThread]: checksum: 568f1e1480817ea4790fb17980df195247d39d7f280a19e6fa3c1e276e1d1417, vars: {}, profile: custom_postgres, target: dev, version: 1.9.0
[0m06:25:24.739640 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:25:24.740206 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://models/example/film_ratings.sql
[0m06:25:25.133924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'acdc9753-e8f7-4628-96ce-0d03de6e958b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac885f8f770>]}
[0m06:25:25.212567 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m06:25:25.214929 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m06:25:25.237159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'acdc9753-e8f7-4628-96ce-0d03de6e958b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac885ebfa70>]}
[0m06:25:25.237550 [info ] [MainThread]: Found 4 models, 20 data tests, 3 sources, 429 macros
[0m06:25:25.237813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'acdc9753-e8f7-4628-96ce-0d03de6e958b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac885ef0950>]}
[0m06:25:25.239613 [info ] [MainThread]: 
[0m06:25:25.239893 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:25:25.240153 [info ] [MainThread]: 
[0m06:25:25.240561 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:25:25.244407 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m06:25:25.280979 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m06:25:25.281295 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m06:25:25.281498 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:25:25.290255 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.009 seconds
[0m06:25:25.291422 [debug] [ThreadPool]: On list_destination_db: Close
[0m06:25:25.292616 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_destination_db, now list_destination_db_public)
[0m06:25:25.297145 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m06:25:25.297359 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m06:25:25.297547 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:25:25.302461 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m06:25:25.302729 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m06:25:25.302940 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m06:25:25.305407 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m06:25:25.306388 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m06:25:25.306667 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m06:25:25.310803 [debug] [MainThread]: Using postgres connection "master"
[0m06:25:25.311112 [debug] [MainThread]: On master: BEGIN
[0m06:25:25.311342 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:25:25.317287 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m06:25:25.317819 [debug] [MainThread]: Using postgres connection "master"
[0m06:25:25.318332 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:25:25.322073 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m06:25:25.323308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'acdc9753-e8f7-4628-96ce-0d03de6e958b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac885ecba10>]}
[0m06:25:25.323670 [debug] [MainThread]: On master: ROLLBACK
[0m06:25:25.323964 [debug] [MainThread]: Using postgres connection "master"
[0m06:25:25.324202 [debug] [MainThread]: On master: BEGIN
[0m06:25:25.324552 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:25:25.324855 [debug] [MainThread]: On master: COMMIT
[0m06:25:25.325097 [debug] [MainThread]: Using postgres connection "master"
[0m06:25:25.325317 [debug] [MainThread]: On master: COMMIT
[0m06:25:25.325598 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:25:25.325829 [debug] [MainThread]: On master: Close
[0m06:25:25.327329 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m06:25:25.327792 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m06:25:25.328150 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_destination_db_public, now model.custom_postgres.actors)
[0m06:25:25.328406 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m06:25:25.334235 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m06:25:25.334772 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m06:25:25.365929 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m06:25:25.366505 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:25:25.366751 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m06:25:25.366978 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:25:25.372956 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m06:25:25.373328 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:25:25.373575 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m06:25:25.374064 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                           ^

[0m06:25:25.374438 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m06:25:25.374936 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m06:25:25.379290 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/actors.sql
[0m06:25:25.380637 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acdc9753-e8f7-4628-96ce-0d03de6e958b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac889dbe750>]}
[0m06:25:25.381119 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.05s]
[0m06:25:25.381641 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m06:25:25.381963 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m06:25:25.382628 [debug] [Thread-4 (]: Marking all children of 'model.custom_postgres.actors' to be skipped because of status 'error'.  Reason: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/actors.sql.
[0m06:25:25.383146 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m06:25:25.384364 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.actors, now model.custom_postgres.film_actors)
[0m06:25:25.384638 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m06:25:25.388274 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m06:25:25.388784 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m06:25:25.390953 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m06:25:25.391358 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:25:25.391615 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m06:25:25.391850 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:25:25.397597 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m06:25:25.397940 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:25:25.398199 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m06:25:25.398679 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                           ^

[0m06:25:25.399056 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m06:25:25.399452 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m06:25:25.401810 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/film_actors.sql
[0m06:25:25.402217 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acdc9753-e8f7-4628-96ce-0d03de6e958b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac8851a0b90>]}
[0m06:25:25.402695 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.02s]
[0m06:25:25.403132 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m06:25:25.403415 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m06:25:25.404060 [debug] [Thread-4 (]: Marking all children of 'model.custom_postgres.film_actors' to be skipped because of status 'error'.  Reason: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/film_actors.sql.
[0m06:25:25.404599 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m06:25:25.405271 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.film_actors, now model.custom_postgres.films)
[0m06:25:25.405570 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m06:25:25.407600 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m06:25:25.408022 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m06:25:25.410100 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m06:25:25.410483 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:25:25.410724 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m06:25:25.410950 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:25:25.417089 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m06:25:25.417682 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:25:25.417922 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m06:25:25.418457 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."films"
                           ^

[0m06:25:25.418753 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m06:25:25.419173 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m06:25:25.421673 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled code at target/run/custom_postgres/models/example/films.sql
[0m06:25:25.422098 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acdc9753-e8f7-4628-96ce-0d03de6e958b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac88501d640>]}
[0m06:25:25.422565 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.02s]
[0m06:25:25.423083 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m06:25:25.423533 [debug] [Thread-4 (]: Marking all children of 'model.custom_postgres.films' to be skipped because of status 'error'.  Reason: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled code at target/run/custom_postgres/models/example/films.sql.
[0m06:25:25.424290 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m06:25:25.424592 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m06:25:25.424920 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m06:25:25.426099 [debug] [MainThread]: Using postgres connection "master"
[0m06:25:25.426620 [debug] [MainThread]: On master: BEGIN
[0m06:25:25.427045 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:25:25.432409 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m06:25:25.432786 [debug] [MainThread]: On master: COMMIT
[0m06:25:25.433012 [debug] [MainThread]: Using postgres connection "master"
[0m06:25:25.433242 [debug] [MainThread]: On master: COMMIT
[0m06:25:25.433518 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:25:25.433746 [debug] [MainThread]: On master: Close
[0m06:25:25.434142 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:25:25.434366 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m06:25:25.434677 [info ] [MainThread]: 
[0m06:25:25.434969 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m06:25:25.435998 [debug] [MainThread]: Command end result
[0m06:25:25.457184 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m06:25:25.458625 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m06:25:25.463672 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m06:25:25.463904 [info ] [MainThread]: 
[0m06:25:25.464207 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m06:25:25.464521 [info ] [MainThread]: 
[0m06:25:25.464919 [error] [MainThread]:   Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/actors.sql
[0m06:25:25.465234 [info ] [MainThread]: 
[0m06:25:25.465603 [error] [MainThread]:   Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/film_actors.sql
[0m06:25:25.466008 [info ] [MainThread]: 
[0m06:25:25.466641 [error] [MainThread]:   Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled code at target/run/custom_postgres/models/example/films.sql
[0m06:25:25.466893 [info ] [MainThread]: 
[0m06:25:25.467174 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m06:25:25.468060 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.2005718, "process_in_blocks": "0", "process_kernel_time": 0.272147, "process_mem_max_rss": "114536", "process_out_blocks": "4496", "process_user_time": 2.014095}
[0m06:25:25.468498 [debug] [MainThread]: Command `dbt run` failed at 06:25:25.468413 after 1.20 seconds
[0m06:25:25.468864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac8895760f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac8877836b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac885eb0950>]}
[0m06:25:25.469227 [debug] [MainThread]: Flushing usage events
[0m06:25:26.724116 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:25:34.384203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1764a09b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1764e70c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1764670bf0>]}


============================== 06:25:34.386743 | b736abc9-96e9-439f-9809-9c06d4bcf44b ==============================
[0m06:25:34.386743 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:25:34.387116 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/dbt/logs', 'profiles_dir': '/root', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'send_anonymous_usage_stats': 'True'}
[0m06:25:34.532383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b736abc9-96e9-439f-9809-9c06d4bcf44b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b17644b4ad0>]}
[0m06:25:34.585610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b736abc9-96e9-439f-9809-9c06d4bcf44b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b17644b44d0>]}
[0m06:25:34.586323 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:25:34.671454 [debug] [MainThread]: checksum: 568f1e1480817ea4790fb17980df195247d39d7f280a19e6fa3c1e276e1d1417, vars: {}, profile: custom_postgres, target: dev, version: 1.9.0
[0m06:25:34.778518 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:25:34.778828 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:25:34.821175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b736abc9-96e9-439f-9809-9c06d4bcf44b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1762c2d4c0>]}
[0m06:25:34.900564 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m06:25:34.902664 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m06:25:34.916779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b736abc9-96e9-439f-9809-9c06d4bcf44b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1762993860>]}
[0m06:25:34.917158 [info ] [MainThread]: Found 4 models, 20 data tests, 3 sources, 429 macros
[0m06:25:34.917435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b736abc9-96e9-439f-9809-9c06d4bcf44b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1764a83770>]}
[0m06:25:34.919316 [info ] [MainThread]: 
[0m06:25:34.919594 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:25:34.919901 [info ] [MainThread]: 
[0m06:25:34.920473 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:25:34.924409 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m06:25:34.961470 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m06:25:34.961782 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m06:25:34.961989 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:25:34.969556 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.007 seconds
[0m06:25:34.970670 [debug] [ThreadPool]: On list_destination_db: Close
[0m06:25:34.972356 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_destination_db, now list_destination_db_public)
[0m06:25:34.978003 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m06:25:34.978244 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m06:25:34.978439 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:25:34.983190 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m06:25:34.983456 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m06:25:34.983674 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m06:25:34.986142 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m06:25:34.987238 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m06:25:34.987518 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m06:25:34.992239 [debug] [MainThread]: Using postgres connection "master"
[0m06:25:34.992495 [debug] [MainThread]: On master: BEGIN
[0m06:25:34.992703 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:25:34.998616 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m06:25:34.999035 [debug] [MainThread]: Using postgres connection "master"
[0m06:25:34.999330 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:25:35.002779 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m06:25:35.004089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b736abc9-96e9-439f-9809-9c06d4bcf44b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1762c53e00>]}
[0m06:25:35.004453 [debug] [MainThread]: On master: ROLLBACK
[0m06:25:35.004777 [debug] [MainThread]: Using postgres connection "master"
[0m06:25:35.005086 [debug] [MainThread]: On master: BEGIN
[0m06:25:35.005446 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:25:35.005831 [debug] [MainThread]: On master: COMMIT
[0m06:25:35.006266 [debug] [MainThread]: Using postgres connection "master"
[0m06:25:35.006630 [debug] [MainThread]: On master: COMMIT
[0m06:25:35.007089 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:25:35.007496 [debug] [MainThread]: On master: Close
[0m06:25:35.009339 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m06:25:35.009832 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m06:25:35.010411 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_destination_db_public, now model.custom_postgres.actors)
[0m06:25:35.010892 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m06:25:35.018009 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m06:25:35.018467 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m06:25:35.049243 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m06:25:35.049768 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:25:35.050015 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m06:25:35.050258 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:25:35.056201 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m06:25:35.056659 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:25:35.056907 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m06:25:35.058219 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.001 seconds
[0m06:25:35.063255 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:25:35.063560 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m06:25:35.064070 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:25:35.066221 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:25:35.066470 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m06:25:35.066851 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:25:35.083096 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m06:25:35.083388 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:25:35.083635 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m06:25:35.084519 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m06:25:35.089026 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."actors__dbt_backup"
[0m06:25:35.093234 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:25:35.093495 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m06:25:35.096017 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m06:25:35.097852 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m06:25:35.099186 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b736abc9-96e9-439f-9809-9c06d4bcf44b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b17643d8320>]}
[0m06:25:35.099765 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.09s]
[0m06:25:35.100273 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m06:25:35.100610 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m06:25:35.101059 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m06:25:35.101424 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.actors, now model.custom_postgres.film_actors)
[0m06:25:35.101730 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m06:25:35.104081 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m06:25:35.104552 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m06:25:35.106971 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m06:25:35.107421 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:25:35.107667 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m06:25:35.107900 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:25:35.113509 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m06:25:35.113873 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:25:35.114126 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m06:25:35.115321 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.001 seconds
[0m06:25:35.117638 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:25:35.117901 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m06:25:35.118316 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:25:35.120242 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:25:35.120487 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m06:25:35.120859 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:25:35.121991 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m06:25:35.122240 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:25:35.122467 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m06:25:35.123098 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m06:25:35.125480 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."film_actors__dbt_backup"
[0m06:25:35.125892 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:25:35.126138 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m06:25:35.127571 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m06:25:35.128523 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m06:25:35.128922 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b736abc9-96e9-439f-9809-9c06d4bcf44b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1760238680>]}
[0m06:25:35.129346 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.03s]
[0m06:25:35.129797 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m06:25:35.130141 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m06:25:35.130491 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m06:25:35.130825 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.film_actors, now model.custom_postgres.films)
[0m06:25:35.131141 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m06:25:35.133011 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m06:25:35.133448 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m06:25:35.135671 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m06:25:35.136059 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:25:35.136301 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m06:25:35.136525 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:25:35.142645 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m06:25:35.143058 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:25:35.143304 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m06:25:35.144502 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.001 seconds
[0m06:25:35.146736 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:25:35.146985 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m06:25:35.147428 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:25:35.149224 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:25:35.149466 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m06:25:35.149829 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:25:35.151106 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m06:25:35.151363 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:25:35.151594 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m06:25:35.152521 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m06:25:35.154692 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."films__dbt_backup"
[0m06:25:35.155237 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:25:35.155491 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m06:25:35.157376 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m06:25:35.158486 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m06:25:35.158889 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b736abc9-96e9-439f-9809-9c06d4bcf44b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1761b4c800>]}
[0m06:25:35.159327 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.03s]
[0m06:25:35.159785 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m06:25:35.160470 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m06:25:35.160776 [info ] [Thread-1 (]: 4 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m06:25:35.161087 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.films, now model.custom_postgres.film_ratings)
[0m06:25:35.161559 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m06:25:35.164409 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m06:25:35.164892 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m06:25:35.167311 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m06:25:35.167727 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m06:25:35.167976 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m06:25:35.168218 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:25:35.173015 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m06:25:35.173374 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m06:25:35.173681 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  
  
    as
  
  (
    WITH films_with_ratings AS (
    SELECT
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        CASE
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Good'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END AS rating_category
    FROM "destination_db"."public"."films"
),

films_with_actors AS (
    SELECT
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ', ') AS actors
    FROM "destination_db"."public"."films" AS f
    LEFT JOIN "destination_db"."public"."actors" AS fa ON fa.film_id = f.film_id
    LEFT JOIN "destination_db"."public"."actors" AS a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title
)

SELECT
    fwf.*,
    fwa.actors
FROM films_with_ratings AS fwf
LEFT JOIN films_with_actors AS fwa ON fwf.film_id = fwa.film_id
  );
  
[0m06:25:35.174614 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column fa.film_id does not exist
LINE 35: ... JOIN "destination_db"."public"."actors" AS fa ON fa.film_id...
                                                              ^
HINT:  Perhaps you meant to reference the column "f.film_id".

[0m06:25:35.175234 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: ROLLBACK
[0m06:25:35.175841 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m06:25:35.179156 [debug] [Thread-1 (]: Database Error in model film_ratings (models/example/film_ratings.sql)
  column fa.film_id does not exist
  LINE 35: ... JOIN "destination_db"."public"."actors" AS fa ON fa.film_id...
                                                                ^
  HINT:  Perhaps you meant to reference the column "f.film_id".
  compiled code at target/run/custom_postgres/models/example/film_ratings.sql
[0m06:25:35.179565 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b736abc9-96e9-439f-9809-9c06d4bcf44b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1761b39d30>]}
[0m06:25:35.180100 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model public.film_ratings ...................... [[31mERROR[0m in 0.02s]
[0m06:25:35.180584 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m06:25:35.181258 [debug] [Thread-4 (]: Marking all children of 'model.custom_postgres.film_ratings' to be skipped because of status 'error'.  Reason: Database Error in model film_ratings (models/example/film_ratings.sql)
  column fa.film_id does not exist
  LINE 35: ... JOIN "destination_db"."public"."actors" AS fa ON fa.film_id...
                                                                ^
  HINT:  Perhaps you meant to reference the column "f.film_id".
  compiled code at target/run/custom_postgres/models/example/film_ratings.sql.
[0m06:25:35.183596 [debug] [MainThread]: Using postgres connection "master"
[0m06:25:35.184083 [debug] [MainThread]: On master: BEGIN
[0m06:25:35.184498 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:25:35.190264 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m06:25:35.190600 [debug] [MainThread]: On master: COMMIT
[0m06:25:35.190821 [debug] [MainThread]: Using postgres connection "master"
[0m06:25:35.191036 [debug] [MainThread]: On master: COMMIT
[0m06:25:35.191306 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:25:35.191610 [debug] [MainThread]: On master: Close
[0m06:25:35.191962 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:25:35.192172 [debug] [MainThread]: Connection 'model.custom_postgres.film_ratings' was properly closed.
[0m06:25:35.192455 [info ] [MainThread]: 
[0m06:25:35.192731 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m06:25:35.193937 [debug] [MainThread]: Command end result
[0m06:25:35.215955 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m06:25:35.217488 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m06:25:35.222924 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m06:25:35.223166 [info ] [MainThread]: 
[0m06:25:35.223449 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m06:25:35.223747 [info ] [MainThread]: 
[0m06:25:35.224128 [error] [MainThread]:   Database Error in model film_ratings (models/example/film_ratings.sql)
  column fa.film_id does not exist
  LINE 35: ... JOIN "destination_db"."public"."actors" AS fa ON fa.film_id...
                                                                ^
  HINT:  Perhaps you meant to reference the column "f.film_id".
  compiled code at target/run/custom_postgres/models/example/film_ratings.sql
[0m06:25:35.224413 [info ] [MainThread]: 
[0m06:25:35.224716 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m06:25:35.225587 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.9134495, "process_in_blocks": "0", "process_kernel_time": 0.269282, "process_mem_max_rss": "107600", "process_out_blocks": "2048", "process_user_time": 1.635641}
[0m06:25:35.225993 [debug] [MainThread]: Command `dbt run` failed at 06:25:35.225901 after 0.91 seconds
[0m06:25:35.226384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1764817da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1764670bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1761cb69f0>]}
[0m06:25:35.226676 [debug] [MainThread]: Flushing usage events
[0m06:25:36.589454 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:27:03.346223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76073d270c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76073cb68c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76073d384950>]}


============================== 06:27:03.348828 | 1f53ac45-6896-4428-a755-3dc4a7a9270e ==============================
[0m06:27:03.348828 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:27:03.349242 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'profiles_dir': '/root', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:27:03.495553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f53ac45-6896-4428-a755-3dc4a7a9270e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76073e4a3410>]}
[0m06:27:03.548945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1f53ac45-6896-4428-a755-3dc4a7a9270e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76073c753740>]}
[0m06:27:03.549536 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:27:03.632959 [debug] [MainThread]: checksum: 568f1e1480817ea4790fb17980df195247d39d7f280a19e6fa3c1e276e1d1417, vars: {}, profile: custom_postgres, target: dev, version: 1.9.0
[0m06:27:03.739756 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:27:03.740315 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://models/example/film_ratings.sql
[0m06:27:04.125790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1f53ac45-6896-4428-a755-3dc4a7a9270e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76073abc6f60>]}
[0m06:27:04.201833 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m06:27:04.204002 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m06:27:04.218059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1f53ac45-6896-4428-a755-3dc4a7a9270e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7607392769f0>]}
[0m06:27:04.218429 [info ] [MainThread]: Found 4 models, 20 data tests, 3 sources, 429 macros
[0m06:27:04.218689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f53ac45-6896-4428-a755-3dc4a7a9270e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76073abfefc0>]}
[0m06:27:04.220444 [info ] [MainThread]: 
[0m06:27:04.220718 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:27:04.220955 [info ] [MainThread]: 
[0m06:27:04.221517 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:27:04.225921 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m06:27:04.262201 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m06:27:04.262518 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m06:27:04.262724 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:27:04.269344 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.007 seconds
[0m06:27:04.270399 [debug] [ThreadPool]: On list_destination_db: Close
[0m06:27:04.271775 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_destination_db, now list_destination_db_public)
[0m06:27:04.276198 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m06:27:04.276412 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m06:27:04.276598 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:27:04.281058 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m06:27:04.281405 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m06:27:04.281623 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m06:27:04.284177 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m06:27:04.285326 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m06:27:04.285616 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m06:27:04.290516 [debug] [MainThread]: Using postgres connection "master"
[0m06:27:04.290770 [debug] [MainThread]: On master: BEGIN
[0m06:27:04.290978 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:27:04.295526 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m06:27:04.295791 [debug] [MainThread]: Using postgres connection "master"
[0m06:27:04.296092 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:27:04.298852 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m06:27:04.299991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f53ac45-6896-4428-a755-3dc4a7a9270e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76073aaf58e0>]}
[0m06:27:04.300328 [debug] [MainThread]: On master: ROLLBACK
[0m06:27:04.300603 [debug] [MainThread]: Using postgres connection "master"
[0m06:27:04.300815 [debug] [MainThread]: On master: BEGIN
[0m06:27:04.301133 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:27:04.301368 [debug] [MainThread]: On master: COMMIT
[0m06:27:04.301590 [debug] [MainThread]: Using postgres connection "master"
[0m06:27:04.301794 [debug] [MainThread]: On master: COMMIT
[0m06:27:04.302058 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:27:04.302278 [debug] [MainThread]: On master: Close
[0m06:27:04.303758 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m06:27:04.304143 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m06:27:04.304463 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_destination_db_public, now model.custom_postgres.actors)
[0m06:27:04.304707 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m06:27:04.310233 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m06:27:04.310669 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m06:27:04.341441 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m06:27:04.341895 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:27:04.342146 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m06:27:04.342369 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:27:04.347438 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m06:27:04.347859 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:27:04.348117 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m06:27:04.349325 [debug] [Thread-1 (]: SQL status: SELECT 40 in 0.001 seconds
[0m06:27:04.355730 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:27:04.356075 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m06:27:04.356611 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:27:04.358663 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:27:04.358910 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m06:27:04.359381 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:27:04.375007 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m06:27:04.375291 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:27:04.375522 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m06:27:04.376291 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m06:27:04.380826 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."actors__dbt_backup"
[0m06:27:04.385012 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:27:04.385281 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m06:27:04.386703 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m06:27:04.388505 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m06:27:04.389733 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f53ac45-6896-4428-a755-3dc4a7a9270e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76073852bbf0>]}
[0m06:27:04.390185 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 40[0m in 0.08s]
[0m06:27:04.390665 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m06:27:04.391016 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m06:27:04.391442 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m06:27:04.391789 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.actors, now model.custom_postgres.film_actors)
[0m06:27:04.392105 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m06:27:04.394219 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m06:27:04.394691 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m06:27:04.396960 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m06:27:04.397362 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:27:04.397601 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m06:27:04.397829 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:27:04.403299 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m06:27:04.403665 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:27:04.403920 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m06:27:04.404986 [debug] [Thread-1 (]: SQL status: SELECT 40 in 0.001 seconds
[0m06:27:04.407306 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:27:04.407560 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m06:27:04.407965 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:27:04.409854 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:27:04.410109 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m06:27:04.410454 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:27:04.411584 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m06:27:04.411868 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:27:04.412106 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m06:27:04.413066 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m06:27:04.414535 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."film_actors__dbt_backup"
[0m06:27:04.414954 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:27:04.415218 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m06:27:04.416825 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m06:27:04.417783 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m06:27:04.418199 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f53ac45-6896-4428-a755-3dc4a7a9270e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76073848c7d0>]}
[0m06:27:04.418613 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 40[0m in 0.03s]
[0m06:27:04.419117 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m06:27:04.419431 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m06:27:04.419934 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m06:27:04.420544 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.film_actors, now model.custom_postgres.films)
[0m06:27:04.420903 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m06:27:04.423850 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m06:27:04.424315 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m06:27:04.426427 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m06:27:04.426805 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:27:04.427056 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m06:27:04.427280 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:27:04.433317 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m06:27:04.433670 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:27:04.433914 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m06:27:04.435510 [debug] [Thread-1 (]: SQL status: SELECT 40 in 0.001 seconds
[0m06:27:04.437911 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:27:04.438187 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m06:27:04.438664 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:27:04.441115 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:27:04.441553 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m06:27:04.442202 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:27:04.443540 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m06:27:04.443799 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:27:04.444115 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m06:27:04.445143 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m06:27:04.446704 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."films__dbt_backup"
[0m06:27:04.447183 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:27:04.447427 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m06:27:04.449123 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m06:27:04.450143 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m06:27:04.450595 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f53ac45-6896-4428-a755-3dc4a7a9270e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7607383580e0>]}
[0m06:27:04.451133 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.films ................................. [[32mSELECT 40[0m in 0.03s]
[0m06:27:04.451685 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m06:27:04.452817 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m06:27:04.453180 [info ] [Thread-1 (]: 4 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m06:27:04.453547 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.films, now model.custom_postgres.film_ratings)
[0m06:27:04.453823 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m06:27:04.456551 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m06:27:04.457041 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m06:27:04.459545 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m06:27:04.459952 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m06:27:04.460206 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m06:27:04.460429 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:27:04.465728 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m06:27:04.466085 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m06:27:04.466370 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  
  
    as
  
  (
    WITH films_with_ratings AS (
    SELECT
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        CASE
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Good'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END AS rating_category
    FROM "destination_db"."public"."films"
),

films_with_actors AS (
    SELECT
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ', ') AS actors
    FROM "destination_db"."public"."films" AS f
    LEFT JOIN "destination_db"."public"."film_actors" AS fa ON fa.film_id = f.film_id
    LEFT JOIN "destination_db"."public"."actors" AS a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title
)

SELECT
    fwf.*,
    fwa.actors
FROM films_with_ratings AS fwf
LEFT JOIN films_with_actors AS fwa ON fwf.film_id = fwa.film_id
  );
  
[0m06:27:04.469005 [debug] [Thread-1 (]: SQL status: SELECT 40 in 0.002 seconds
[0m06:27:04.471207 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m06:27:04.471454 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings__dbt_tmp" rename to "film_ratings"
[0m06:27:04.471819 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:27:04.472829 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m06:27:04.473076 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m06:27:04.473303 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m06:27:04.473995 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m06:27:04.475414 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."film_ratings__dbt_backup"
[0m06:27:04.475818 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m06:27:04.476061 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
drop table if exists "destination_db"."public"."film_ratings__dbt_backup" cascade
[0m06:27:04.476386 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m06:27:04.477314 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m06:27:04.477703 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f53ac45-6896-4428-a755-3dc4a7a9270e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76073854a810>]}
[0m06:27:04.478116 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public.film_ratings .......................... [[32mSELECT 40[0m in 0.02s]
[0m06:27:04.478568 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m06:27:04.479599 [debug] [MainThread]: Using postgres connection "master"
[0m06:27:04.479843 [debug] [MainThread]: On master: BEGIN
[0m06:27:04.480067 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:27:04.486917 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m06:27:04.487352 [debug] [MainThread]: On master: COMMIT
[0m06:27:04.487605 [debug] [MainThread]: Using postgres connection "master"
[0m06:27:04.487828 [debug] [MainThread]: On master: COMMIT
[0m06:27:04.488153 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:27:04.488388 [debug] [MainThread]: On master: Close
[0m06:27:04.488747 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:27:04.488956 [debug] [MainThread]: Connection 'model.custom_postgres.film_ratings' was properly closed.
[0m06:27:04.489262 [info ] [MainThread]: 
[0m06:27:04.489528 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m06:27:04.490532 [debug] [MainThread]: Command end result
[0m06:27:04.522895 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m06:27:04.524261 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m06:27:04.529265 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m06:27:04.529490 [info ] [MainThread]: 
[0m06:27:04.529792 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:27:04.530053 [info ] [MainThread]: 
[0m06:27:04.530333 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m06:27:04.531132 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2671895, "process_in_blocks": "0", "process_kernel_time": 0.268202, "process_mem_max_rss": "112580", "process_out_blocks": "2928", "process_user_time": 2.029963}
[0m06:27:04.531528 [debug] [MainThread]: Command `dbt run` succeeded at 06:27:04.531444 after 1.27 seconds
[0m06:27:04.531803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76073cc5b770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7607394280e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76073862e840>]}
[0m06:27:04.532080 [debug] [MainThread]: Flushing usage events
[0m06:27:06.229690 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:34:38.016622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7de507a41eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7de507c054f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7de507a42090>]}


============================== 06:34:38.022362 | 99f2a5b3-376a-4cc9-8a1a-a81e94287833 ==============================
[0m06:34:38.022362 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:34:38.022774 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:34:38.199855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '99f2a5b3-376a-4cc9-8a1a-a81e94287833', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7de50772b560>]}
[0m06:34:38.251996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '99f2a5b3-376a-4cc9-8a1a-a81e94287833', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7de50803d640>]}
[0m06:34:38.252574 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:34:38.338496 [debug] [MainThread]: checksum: 568f1e1480817ea4790fb17980df195247d39d7f280a19e6fa3c1e276e1d1417, vars: {}, profile: custom_postgres, target: dev, version: 1.9.0
[0m06:34:38.445428 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m06:34:38.445903 [debug] [MainThread]: Partial parsing: added file: custom_postgres://macros/film_ratings.macro.sql
[0m06:34:38.446272 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://models/example/film_ratings.sql
[0m06:34:38.841350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '99f2a5b3-376a-4cc9-8a1a-a81e94287833', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7de4fff25af0>]}
[0m06:34:38.919639 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m06:34:38.921751 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m06:34:38.943845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '99f2a5b3-376a-4cc9-8a1a-a81e94287833', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7de5087fb2c0>]}
[0m06:34:38.944227 [info ] [MainThread]: Found 4 models, 20 data tests, 3 sources, 430 macros
[0m06:34:38.944473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99f2a5b3-376a-4cc9-8a1a-a81e94287833', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7de5040bd3a0>]}
[0m06:34:38.946250 [info ] [MainThread]: 
[0m06:34:38.946537 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:34:38.946834 [info ] [MainThread]: 
[0m06:34:38.947339 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:34:38.951239 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m06:34:38.985832 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m06:34:38.986138 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m06:34:38.986335 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:34:38.995989 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.010 seconds
[0m06:34:38.997153 [debug] [ThreadPool]: On list_destination_db: Close
[0m06:34:38.998440 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_destination_db, now list_destination_db_public)
[0m06:34:39.004591 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m06:34:39.004807 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m06:34:39.004993 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:34:39.009188 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m06:34:39.009458 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m06:34:39.009674 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m06:34:39.012164 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m06:34:39.013258 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m06:34:39.013517 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m06:34:39.017066 [debug] [MainThread]: Using postgres connection "master"
[0m06:34:39.017334 [debug] [MainThread]: On master: BEGIN
[0m06:34:39.017541 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:34:39.022669 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m06:34:39.023079 [debug] [MainThread]: Using postgres connection "master"
[0m06:34:39.023385 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:34:39.026238 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m06:34:39.027432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99f2a5b3-376a-4cc9-8a1a-a81e94287833', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7de5073df800>]}
[0m06:34:39.027777 [debug] [MainThread]: On master: ROLLBACK
[0m06:34:39.028082 [debug] [MainThread]: Using postgres connection "master"
[0m06:34:39.028303 [debug] [MainThread]: On master: BEGIN
[0m06:34:39.028643 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:34:39.028919 [debug] [MainThread]: On master: COMMIT
[0m06:34:39.029150 [debug] [MainThread]: Using postgres connection "master"
[0m06:34:39.029357 [debug] [MainThread]: On master: COMMIT
[0m06:34:39.029626 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:34:39.029847 [debug] [MainThread]: On master: Close
[0m06:34:39.031348 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m06:34:39.032125 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m06:34:39.032716 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_destination_db_public, now model.custom_postgres.actors)
[0m06:34:39.033189 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m06:34:39.044096 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m06:34:39.044908 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m06:34:39.092620 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m06:34:39.093313 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:34:39.093573 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m06:34:39.093815 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:34:39.098934 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m06:34:39.099322 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:34:39.099583 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m06:34:39.100113 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                           ^

[0m06:34:39.100479 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m06:34:39.101004 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m06:34:39.104395 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/actors.sql
[0m06:34:39.105647 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99f2a5b3-376a-4cc9-8a1a-a81e94287833', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7de507f926c0>]}
[0m06:34:39.106105 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.07s]
[0m06:34:39.106543 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m06:34:39.106892 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m06:34:39.107517 [debug] [Thread-4 (]: Marking all children of 'model.custom_postgres.actors' to be skipped because of status 'error'.  Reason: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/actors.sql.
[0m06:34:39.108049 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m06:34:39.109448 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.actors, now model.custom_postgres.film_actors)
[0m06:34:39.109694 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m06:34:39.111807 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m06:34:39.112279 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m06:34:39.114316 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m06:34:39.114709 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:34:39.114961 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m06:34:39.115200 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:34:39.120726 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m06:34:39.121075 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:34:39.121317 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m06:34:39.121787 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                           ^

[0m06:34:39.122095 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m06:34:39.122442 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m06:34:39.124290 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/film_actors.sql
[0m06:34:39.124628 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99f2a5b3-376a-4cc9-8a1a-a81e94287833', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7de505b41ca0>]}
[0m06:34:39.125065 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.02s]
[0m06:34:39.125527 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m06:34:39.125819 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m06:34:39.126184 [debug] [Thread-4 (]: Marking all children of 'model.custom_postgres.film_actors' to be skipped because of status 'error'.  Reason: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/film_actors.sql.
[0m06:34:39.126681 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m06:34:39.127382 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.film_actors, now model.custom_postgres.films)
[0m06:34:39.127836 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m06:34:39.129984 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m06:34:39.130475 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m06:34:39.132645 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m06:34:39.133107 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:34:39.133352 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m06:34:39.133578 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:34:39.138419 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m06:34:39.138687 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:34:39.138920 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m06:34:39.139367 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."films"
                           ^

[0m06:34:39.139666 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m06:34:39.140236 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m06:34:39.142561 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled code at target/run/custom_postgres/models/example/films.sql
[0m06:34:39.142942 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99f2a5b3-376a-4cc9-8a1a-a81e94287833', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7de4fd877740>]}
[0m06:34:39.143500 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.02s]
[0m06:34:39.144010 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m06:34:39.144405 [debug] [Thread-4 (]: Marking all children of 'model.custom_postgres.films' to be skipped because of status 'error'.  Reason: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled code at target/run/custom_postgres/models/example/films.sql.
[0m06:34:39.145094 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m06:34:39.145356 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m06:34:39.145706 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m06:34:39.147065 [debug] [MainThread]: Using postgres connection "master"
[0m06:34:39.147681 [debug] [MainThread]: On master: BEGIN
[0m06:34:39.148188 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:34:39.153698 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m06:34:39.154146 [debug] [MainThread]: On master: COMMIT
[0m06:34:39.154383 [debug] [MainThread]: Using postgres connection "master"
[0m06:34:39.154602 [debug] [MainThread]: On master: COMMIT
[0m06:34:39.154893 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:34:39.155141 [debug] [MainThread]: On master: Close
[0m06:34:39.155515 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:34:39.155724 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m06:34:39.156019 [info ] [MainThread]: 
[0m06:34:39.156304 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.21 seconds (0.21s).
[0m06:34:39.157380 [debug] [MainThread]: Command end result
[0m06:34:39.179494 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m06:34:39.180903 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m06:34:39.185914 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m06:34:39.186152 [info ] [MainThread]: 
[0m06:34:39.186441 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m06:34:39.186754 [info ] [MainThread]: 
[0m06:34:39.187161 [error] [MainThread]:   Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/actors.sql
[0m06:34:39.187456 [info ] [MainThread]: 
[0m06:34:39.187793 [error] [MainThread]:   Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/film_actors.sql
[0m06:34:39.188100 [info ] [MainThread]: 
[0m06:34:39.188398 [error] [MainThread]:   Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled code at target/run/custom_postgres/models/example/films.sql
[0m06:34:39.188667 [info ] [MainThread]: 
[0m06:34:39.189001 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m06:34:39.189852 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.2129185, "process_in_blocks": "0", "process_kernel_time": 0.280969, "process_mem_max_rss": "113672", "process_out_blocks": "4504", "process_user_time": 2.018781}
[0m06:34:39.190268 [debug] [MainThread]: Command `dbt run` failed at 06:34:39.190181 after 1.21 seconds
[0m06:34:39.190580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7de507c054f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7de507f926c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7de504125040>]}
[0m06:34:39.190939 [debug] [MainThread]: Flushing usage events
[0m06:34:40.616999 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:34:48.031726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71eb5ceab1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71eb5e850710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71eb5eac6090>]}


============================== 06:34:48.034458 | bcaeb1ac-deef-4976-a131-38669b69e015 ==============================
[0m06:34:48.034458 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:34:48.034870 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/root', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:34:48.188107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bcaeb1ac-deef-4976-a131-38669b69e015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71eb5c874ce0>]}
[0m06:34:48.244779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bcaeb1ac-deef-4976-a131-38669b69e015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71eb5d232780>]}
[0m06:34:48.245526 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:34:48.335780 [debug] [MainThread]: checksum: 568f1e1480817ea4790fb17980df195247d39d7f280a19e6fa3c1e276e1d1417, vars: {}, profile: custom_postgres, target: dev, version: 1.9.0
[0m06:34:48.453584 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:34:48.453902 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:34:48.498395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bcaeb1ac-deef-4976-a131-38669b69e015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71eb60026a20>]}
[0m06:34:48.585238 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m06:34:48.587919 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m06:34:48.607692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bcaeb1ac-deef-4976-a131-38669b69e015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71eb5ad63c20>]}
[0m06:34:48.608168 [info ] [MainThread]: Found 4 models, 20 data tests, 3 sources, 430 macros
[0m06:34:48.608435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bcaeb1ac-deef-4976-a131-38669b69e015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71eb5afa1130>]}
[0m06:34:48.610438 [info ] [MainThread]: 
[0m06:34:48.610724 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:34:48.611039 [info ] [MainThread]: 
[0m06:34:48.611606 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:34:48.615771 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m06:34:48.653075 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m06:34:48.653398 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m06:34:48.653609 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:34:48.661023 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.007 seconds
[0m06:34:48.662187 [debug] [ThreadPool]: On list_destination_db: Close
[0m06:34:48.663564 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_destination_db, now list_destination_db_public)
[0m06:34:48.670551 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m06:34:48.671099 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m06:34:48.671364 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:34:48.679051 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m06:34:48.679629 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m06:34:48.679916 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m06:34:48.683530 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.003 seconds
[0m06:34:48.685089 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m06:34:48.685569 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m06:34:48.691810 [debug] [MainThread]: Using postgres connection "master"
[0m06:34:48.692144 [debug] [MainThread]: On master: BEGIN
[0m06:34:48.692365 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:34:48.698252 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m06:34:48.698875 [debug] [MainThread]: Using postgres connection "master"
[0m06:34:48.699308 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:34:48.703398 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m06:34:48.706628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bcaeb1ac-deef-4976-a131-38669b69e015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71eb59ea5c70>]}
[0m06:34:48.707178 [debug] [MainThread]: On master: ROLLBACK
[0m06:34:48.707601 [debug] [MainThread]: Using postgres connection "master"
[0m06:34:48.707846 [debug] [MainThread]: On master: BEGIN
[0m06:34:48.708251 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:34:48.708513 [debug] [MainThread]: On master: COMMIT
[0m06:34:48.708755 [debug] [MainThread]: Using postgres connection "master"
[0m06:34:48.709001 [debug] [MainThread]: On master: COMMIT
[0m06:34:48.709308 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:34:48.709544 [debug] [MainThread]: On master: Close
[0m06:34:48.711328 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m06:34:48.712074 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m06:34:48.712613 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_destination_db_public, now model.custom_postgres.actors)
[0m06:34:48.713538 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m06:34:48.725254 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m06:34:48.726242 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m06:34:48.780076 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m06:34:48.781122 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:34:48.781410 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m06:34:48.781701 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:34:48.788750 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m06:34:48.789281 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:34:48.789547 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m06:34:48.791081 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.001 seconds
[0m06:34:48.797219 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:34:48.797672 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m06:34:48.798574 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:34:48.802081 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:34:48.802439 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m06:34:48.803137 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:34:48.823205 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m06:34:48.823692 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:34:48.824003 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m06:34:48.825210 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m06:34:48.834923 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."actors__dbt_backup"
[0m06:34:48.841140 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:34:48.841741 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m06:34:48.844927 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m06:34:48.848464 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m06:34:48.850662 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bcaeb1ac-deef-4976-a131-38669b69e015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71eb5e5ca780>]}
[0m06:34:48.851452 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.14s]
[0m06:34:48.851942 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m06:34:48.852479 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m06:34:48.853097 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m06:34:48.853574 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.actors, now model.custom_postgres.film_actors)
[0m06:34:48.853925 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m06:34:48.857856 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m06:34:48.859005 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m06:34:48.863741 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m06:34:48.865278 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:34:48.865739 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m06:34:48.866068 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:34:48.875902 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m06:34:48.876413 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:34:48.876679 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m06:34:48.878328 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.001 seconds
[0m06:34:48.881870 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:34:48.882391 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m06:34:48.883232 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:34:48.886703 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:34:48.887160 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m06:34:48.887997 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:34:48.889520 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m06:34:48.889828 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:34:48.890101 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m06:34:48.891242 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m06:34:48.895957 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."film_actors__dbt_backup"
[0m06:34:48.896692 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:34:48.896984 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m06:34:48.899574 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m06:34:48.901581 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m06:34:48.902343 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bcaeb1ac-deef-4976-a131-38669b69e015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71eb5858f4d0>]}
[0m06:34:48.903101 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.05s]
[0m06:34:48.903735 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m06:34:48.904235 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m06:34:48.904907 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m06:34:48.905496 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.film_actors, now model.custom_postgres.films)
[0m06:34:48.905867 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m06:34:48.912467 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m06:34:48.914131 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m06:34:48.920422 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m06:34:48.921912 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:34:48.922321 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m06:34:48.922673 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:34:48.930364 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m06:34:48.930890 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:34:48.931225 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m06:34:48.933133 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.002 seconds
[0m06:34:48.936735 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:34:48.937140 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m06:34:48.937853 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:34:48.940298 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:34:48.940570 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m06:34:48.941066 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:34:48.942386 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m06:34:48.942648 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:34:48.942902 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m06:34:48.943764 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m06:34:48.945855 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."films__dbt_backup"
[0m06:34:48.946318 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:34:48.946571 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m06:34:48.949187 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m06:34:48.950870 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m06:34:48.951507 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bcaeb1ac-deef-4976-a131-38669b69e015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71eb585a25a0>]}
[0m06:34:48.952147 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.05s]
[0m06:34:48.952642 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m06:34:48.953900 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m06:34:48.954326 [info ] [Thread-1 (]: 4 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m06:34:48.954766 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.films, now model.custom_postgres.film_ratings)
[0m06:34:48.955091 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m06:34:48.960432 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m06:34:48.961241 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m06:34:48.964937 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m06:34:48.966001 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m06:34:48.966291 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m06:34:48.966571 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:34:48.972866 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m06:34:48.973482 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m06:34:48.973815 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  
  
    as
  
  (
    

WITH films_with_ratings AS (
    SELECT
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        CASE
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Good'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END AS rating_category
    FROM "destination_db"."public"."films"
),

films_with_actors AS (
    SELECT
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ', ') AS actors
    FROM "destination_db"."public"."films" AS f
    LEFT JOIN "destination_db"."public"."film_actors" AS fa ON fa.film_id = f.film_id
    LEFT JOIN "destination_db"."public"."actors" AS a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title
)

SELECT
    fwf.*,
    fwa.actors
FROM films_with_ratings AS fwf
LEFT JOIN films_with_actors AS fwa ON fwf.film_id = fwa.film_id


  );
  
[0m06:34:48.980859 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.006 seconds
[0m06:34:48.986680 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m06:34:48.987537 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings__dbt_tmp" rename to "film_ratings"
[0m06:34:48.989167 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:34:48.991919 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m06:34:48.992468 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m06:34:48.992815 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m06:34:48.994949 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m06:34:48.999403 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."film_ratings__dbt_backup"
[0m06:34:49.000448 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m06:34:49.000811 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
drop table if exists "destination_db"."public"."film_ratings__dbt_backup" cascade
[0m06:34:49.001860 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m06:34:49.005510 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m06:34:49.006916 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bcaeb1ac-deef-4976-a131-38669b69e015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71eb5a024170>]}
[0m06:34:49.007678 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public.film_ratings .......................... [[32mSELECT 20[0m in 0.05s]
[0m06:34:49.008252 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m06:34:49.010398 [debug] [MainThread]: Using postgres connection "master"
[0m06:34:49.010990 [debug] [MainThread]: On master: BEGIN
[0m06:34:49.011299 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:34:49.019559 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m06:34:49.020572 [debug] [MainThread]: On master: COMMIT
[0m06:34:49.020912 [debug] [MainThread]: Using postgres connection "master"
[0m06:34:49.021256 [debug] [MainThread]: On master: COMMIT
[0m06:34:49.021728 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:34:49.022114 [debug] [MainThread]: On master: Close
[0m06:34:49.023595 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:34:49.024104 [debug] [MainThread]: Connection 'model.custom_postgres.film_ratings' was properly closed.
[0m06:34:49.024667 [info ] [MainThread]: 
[0m06:34:49.025099 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m06:34:49.026639 [debug] [MainThread]: Command end result
[0m06:34:49.062917 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m06:34:49.067774 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m06:34:49.078758 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m06:34:49.079529 [info ] [MainThread]: 
[0m06:34:49.080018 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:34:49.080373 [info ] [MainThread]: 
[0m06:34:49.080759 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m06:34:49.082550 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.1298577, "process_in_blocks": "0", "process_kernel_time": 0.283323, "process_mem_max_rss": "107084", "process_out_blocks": "2048", "process_user_time": 1.828087}
[0m06:34:49.083244 [debug] [MainThread]: Command `dbt run` succeeded at 06:34:49.083106 after 1.13 seconds
[0m06:34:49.083826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71eb5cc03f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71eb5d3e9d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71eb585c9b80>]}
[0m06:34:49.084398 [debug] [MainThread]: Flushing usage events
[0m06:34:50.499411 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:37:46.635478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717340993920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7173414fa330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717340993380>]}


============================== 06:37:46.641953 | ea19f151-ea53-4c6a-883c-684145b217aa ==============================
[0m06:37:46.641953 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:37:46.642456 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:37:46.833944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ea19f151-ea53-4c6a-883c-684145b217aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717340202c90>]}
[0m06:37:46.889360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ea19f151-ea53-4c6a-883c-684145b217aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71733e72eea0>]}
[0m06:37:46.890061 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:37:46.981096 [debug] [MainThread]: checksum: 568f1e1480817ea4790fb17980df195247d39d7f280a19e6fa3c1e276e1d1417, vars: {}, profile: custom_postgres, target: dev, version: 1.9.0
[0m06:37:47.107222 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m06:37:47.107797 [debug] [MainThread]: Partial parsing: added file: custom_postgres://macros/generate_ratings_macro.sql
[0m06:37:47.108292 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://macros/film_ratings.macro.sql
[0m06:37:47.288021 [error] [MainThread]: Encountered an error:
Compilation Error in model film_ratings (models/example/film_ratings.sql)
  'generate_ratings' is undefined
[0m06:37:47.289389 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.695944, "process_in_blocks": "0", "process_kernel_time": 0.256561, "process_mem_max_rss": "99152", "process_out_blocks": "1496", "process_user_time": 1.648183}
[0m06:37:47.289880 [debug] [MainThread]: Command `dbt run` failed at 06:37:47.289785 after 0.70 seconds
[0m06:37:47.290202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717340308c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71733e58c080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71733e4b9cd0>]}
[0m06:37:47.290487 [debug] [MainThread]: Flushing usage events
[0m06:37:48.515953 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:38:05.554572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a0dc4f1d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a0db6e1340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a0db3a8500>]}


============================== 06:38:05.560411 | 1e18c875-e4be-46cc-9f7c-97e1fcf2921b ==============================
[0m06:38:05.560411 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:38:05.560875 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root', 'debug': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'send_anonymous_usage_stats': 'True'}
[0m06:38:05.759854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1e18c875-e4be-46cc-9f7c-97e1fcf2921b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a0d96f9070>]}
[0m06:38:05.817945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1e18c875-e4be-46cc-9f7c-97e1fcf2921b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a0dbc454c0>]}
[0m06:38:05.818673 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:38:05.909296 [debug] [MainThread]: checksum: 568f1e1480817ea4790fb17980df195247d39d7f280a19e6fa3c1e276e1d1417, vars: {}, profile: custom_postgres, target: dev, version: 1.9.0
[0m06:38:06.025588 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m06:38:06.026126 [debug] [MainThread]: Partial parsing: added file: custom_postgres://macros/generate_ratings_macro.sql
[0m06:38:06.026590 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://macros/film_ratings.macro.sql
[0m06:38:06.450857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e18c875-e4be-46cc-9f7c-97e1fcf2921b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a0d930d010>]}
[0m06:38:06.530948 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m06:38:06.533291 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m06:38:06.556764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e18c875-e4be-46cc-9f7c-97e1fcf2921b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a0d3a910d0>]}
[0m06:38:06.557168 [info ] [MainThread]: Found 4 models, 20 data tests, 3 sources, 431 macros
[0m06:38:06.557441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e18c875-e4be-46cc-9f7c-97e1fcf2921b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a0d9769190>]}
[0m06:38:06.559261 [info ] [MainThread]: 
[0m06:38:06.559542 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:38:06.559809 [info ] [MainThread]: 
[0m06:38:06.560354 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:38:06.564274 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m06:38:06.601884 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m06:38:06.602201 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m06:38:06.602407 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:38:06.612052 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.009 seconds
[0m06:38:06.614394 [debug] [ThreadPool]: On list_destination_db: Close
[0m06:38:06.616381 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_destination_db, now list_destination_db_public)
[0m06:38:06.622252 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m06:38:06.622610 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m06:38:06.622845 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:38:06.627891 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m06:38:06.628272 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m06:38:06.628494 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m06:38:06.631148 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m06:38:06.632224 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m06:38:06.632496 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m06:38:06.637837 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:06.638427 [debug] [MainThread]: On master: BEGIN
[0m06:38:06.638639 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:38:06.643325 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m06:38:06.643667 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:06.643957 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:38:06.647796 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m06:38:06.649724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e18c875-e4be-46cc-9f7c-97e1fcf2921b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a0d93cfc20>]}
[0m06:38:06.650425 [debug] [MainThread]: On master: ROLLBACK
[0m06:38:06.650996 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:06.651467 [debug] [MainThread]: On master: BEGIN
[0m06:38:06.652062 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:38:06.652505 [debug] [MainThread]: On master: COMMIT
[0m06:38:06.652898 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:06.653274 [debug] [MainThread]: On master: COMMIT
[0m06:38:06.653720 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:38:06.654106 [debug] [MainThread]: On master: Close
[0m06:38:06.656276 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m06:38:06.656791 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m06:38:06.657176 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_destination_db_public, now model.custom_postgres.actors)
[0m06:38:06.657429 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m06:38:06.663097 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m06:38:06.663561 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m06:38:06.697574 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m06:38:06.698179 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:38:06.698431 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m06:38:06.698660 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:38:06.704130 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m06:38:06.704476 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:38:06.704714 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m06:38:06.705172 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                           ^

[0m06:38:06.705501 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m06:38:06.705895 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m06:38:06.709676 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/actors.sql
[0m06:38:06.711447 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e18c875-e4be-46cc-9f7c-97e1fcf2921b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a0d93c4c80>]}
[0m06:38:06.712021 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.05s]
[0m06:38:06.712604 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m06:38:06.712994 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m06:38:06.713480 [debug] [Thread-4 (]: Marking all children of 'model.custom_postgres.actors' to be skipped because of status 'error'.  Reason: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/actors.sql.
[0m06:38:06.713910 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m06:38:06.715062 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.actors, now model.custom_postgres.film_actors)
[0m06:38:06.715418 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m06:38:06.717667 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m06:38:06.718126 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m06:38:06.720253 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m06:38:06.720658 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:38:06.720901 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m06:38:06.721145 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:38:06.726431 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m06:38:06.726812 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:38:06.727074 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m06:38:06.727537 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                           ^

[0m06:38:06.727794 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m06:38:06.728168 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m06:38:06.730002 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/film_actors.sql
[0m06:38:06.730351 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e18c875-e4be-46cc-9f7c-97e1fcf2921b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a0d3a61850>]}
[0m06:38:06.730798 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.02s]
[0m06:38:06.731220 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m06:38:06.731493 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m06:38:06.731948 [debug] [Thread-4 (]: Marking all children of 'model.custom_postgres.film_actors' to be skipped because of status 'error'.  Reason: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/film_actors.sql.
[0m06:38:06.732433 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m06:38:06.733057 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.film_actors, now model.custom_postgres.films)
[0m06:38:06.733311 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m06:38:06.735382 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m06:38:06.735851 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m06:38:06.737984 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m06:38:06.738381 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:38:06.738618 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m06:38:06.738837 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:38:06.745115 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m06:38:06.745742 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:38:06.746114 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m06:38:06.746641 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."films"
                           ^

[0m06:38:06.747138 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m06:38:06.747550 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m06:38:06.749915 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled code at target/run/custom_postgres/models/example/films.sql
[0m06:38:06.750377 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e18c875-e4be-46cc-9f7c-97e1fcf2921b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a0d2d17ce0>]}
[0m06:38:06.750934 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.02s]
[0m06:38:06.751452 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m06:38:06.752264 [debug] [Thread-4 (]: Marking all children of 'model.custom_postgres.films' to be skipped because of status 'error'.  Reason: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled code at target/run/custom_postgres/models/example/films.sql.
[0m06:38:06.753449 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m06:38:06.753766 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m06:38:06.754117 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m06:38:06.755117 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:06.755429 [debug] [MainThread]: On master: BEGIN
[0m06:38:06.755648 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:38:06.760572 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m06:38:06.761089 [debug] [MainThread]: On master: COMMIT
[0m06:38:06.761467 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:06.761825 [debug] [MainThread]: On master: COMMIT
[0m06:38:06.762286 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:38:06.762671 [debug] [MainThread]: On master: Close
[0m06:38:06.763208 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:38:06.763559 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m06:38:06.764014 [info ] [MainThread]: 
[0m06:38:06.764490 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m06:38:06.766424 [debug] [MainThread]: Command end result
[0m06:38:06.798349 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m06:38:06.799823 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m06:38:06.805849 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m06:38:06.806102 [info ] [MainThread]: 
[0m06:38:06.806396 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m06:38:06.806653 [info ] [MainThread]: 
[0m06:38:06.806961 [error] [MainThread]:   Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/actors.sql
[0m06:38:06.807271 [info ] [MainThread]: 
[0m06:38:06.807609 [error] [MainThread]:   Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/film_actors.sql
[0m06:38:06.807927 [info ] [MainThread]: 
[0m06:38:06.808292 [error] [MainThread]:   Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled code at target/run/custom_postgres/models/example/films.sql
[0m06:38:06.808536 [info ] [MainThread]: 
[0m06:38:06.808844 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m06:38:06.809738 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.296589, "process_in_blocks": "0", "process_kernel_time": 0.28412, "process_mem_max_rss": "113980", "process_out_blocks": "4504", "process_user_time": 2.165921}
[0m06:38:06.810193 [debug] [MainThread]: Command `dbt run` failed at 06:38:06.810094 after 1.30 seconds
[0m06:38:06.810512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a0de55b8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a0dbb20170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a0dbb21160>]}
[0m06:38:06.810797 [debug] [MainThread]: Flushing usage events
[0m06:38:08.086426 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:38:14.122109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ea83b4b200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ea83f6ae70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ea83a34bc0>]}


============================== 06:38:14.124907 | ed7812ec-f979-4cb7-83b6-ad60c1d8ee7a ==============================
[0m06:38:14.124907 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:38:14.125313 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:38:14.283150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ed7812ec-f979-4cb7-83b6-ad60c1d8ee7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ea831b5880>]}
[0m06:38:14.340275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ed7812ec-f979-4cb7-83b6-ad60c1d8ee7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ea82dd1190>]}
[0m06:38:14.341191 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:38:14.432382 [debug] [MainThread]: checksum: 568f1e1480817ea4790fb17980df195247d39d7f280a19e6fa3c1e276e1d1417, vars: {}, profile: custom_postgres, target: dev, version: 1.9.0
[0m06:38:14.550887 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:38:14.551396 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:38:14.598212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ed7812ec-f979-4cb7-83b6-ad60c1d8ee7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ea82dff080>]}
[0m06:38:14.683169 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m06:38:14.685575 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m06:38:14.700510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ed7812ec-f979-4cb7-83b6-ad60c1d8ee7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ea81442b70>]}
[0m06:38:14.700894 [info ] [MainThread]: Found 4 models, 20 data tests, 3 sources, 431 macros
[0m06:38:14.701153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed7812ec-f979-4cb7-83b6-ad60c1d8ee7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ea82e657f0>]}
[0m06:38:14.702866 [info ] [MainThread]: 
[0m06:38:14.703153 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:38:14.703374 [info ] [MainThread]: 
[0m06:38:14.703831 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:38:14.707910 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m06:38:14.746317 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m06:38:14.746790 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m06:38:14.747008 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:38:14.754629 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.008 seconds
[0m06:38:14.755835 [debug] [ThreadPool]: On list_destination_db: Close
[0m06:38:14.757083 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_destination_db, now list_destination_db_public)
[0m06:38:14.761678 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m06:38:14.761896 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m06:38:14.762090 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:38:14.767139 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m06:38:14.767413 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m06:38:14.767629 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m06:38:14.770172 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m06:38:14.771296 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m06:38:14.771579 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m06:38:14.777596 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:14.777964 [debug] [MainThread]: On master: BEGIN
[0m06:38:14.778196 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:38:14.785969 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m06:38:14.786367 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:14.786658 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:38:14.789447 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m06:38:14.790627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed7812ec-f979-4cb7-83b6-ad60c1d8ee7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ea813e7cb0>]}
[0m06:38:14.790983 [debug] [MainThread]: On master: ROLLBACK
[0m06:38:14.791282 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:14.791501 [debug] [MainThread]: On master: BEGIN
[0m06:38:14.791814 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:38:14.792086 [debug] [MainThread]: On master: COMMIT
[0m06:38:14.792307 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:14.792516 [debug] [MainThread]: On master: COMMIT
[0m06:38:14.792787 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:38:14.793018 [debug] [MainThread]: On master: Close
[0m06:38:14.794743 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m06:38:14.795484 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m06:38:14.795896 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_destination_db_public, now model.custom_postgres.actors)
[0m06:38:14.796167 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m06:38:14.802927 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m06:38:14.803488 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m06:38:14.837233 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m06:38:14.837811 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:38:14.838064 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m06:38:14.838293 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:38:14.844827 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m06:38:14.845289 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:38:14.845533 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m06:38:14.846932 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.001 seconds
[0m06:38:14.852082 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:38:14.852366 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m06:38:14.852847 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:38:14.854945 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:38:14.855225 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m06:38:14.855635 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:38:14.871894 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m06:38:14.872214 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:38:14.872454 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m06:38:14.873360 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m06:38:14.879258 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."actors__dbt_backup"
[0m06:38:14.883784 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:38:14.884063 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m06:38:14.886354 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m06:38:14.888278 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m06:38:14.889553 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed7812ec-f979-4cb7-83b6-ad60c1d8ee7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ea84c66480>]}
[0m06:38:14.890010 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.09s]
[0m06:38:14.890517 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m06:38:14.890870 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m06:38:14.891258 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m06:38:14.891599 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.actors, now model.custom_postgres.film_actors)
[0m06:38:14.891947 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m06:38:14.894105 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m06:38:14.894555 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m06:38:14.896847 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m06:38:14.897326 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:38:14.897573 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m06:38:14.897817 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:38:14.903473 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m06:38:14.903849 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:38:14.904111 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m06:38:14.905373 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.001 seconds
[0m06:38:14.907889 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:38:14.908234 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m06:38:14.908852 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:38:14.911518 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:38:14.911820 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m06:38:14.912684 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:38:14.915525 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m06:38:14.915790 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:38:14.916056 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m06:38:14.916835 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m06:38:14.918414 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."film_actors__dbt_backup"
[0m06:38:14.918786 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:38:14.919036 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m06:38:14.920595 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m06:38:14.921626 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m06:38:14.922087 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed7812ec-f979-4cb7-83b6-ad60c1d8ee7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ea80478920>]}
[0m06:38:14.922618 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.03s]
[0m06:38:14.923136 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m06:38:14.923472 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m06:38:14.923946 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m06:38:14.924300 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.film_actors, now model.custom_postgres.films)
[0m06:38:14.924592 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m06:38:14.926499 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m06:38:14.926939 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m06:38:14.929141 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m06:38:14.929528 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:38:14.929768 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m06:38:14.929991 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:38:14.935758 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m06:38:14.936142 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:38:14.936397 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m06:38:14.937647 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.001 seconds
[0m06:38:14.940094 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:38:14.940394 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m06:38:14.940918 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:38:14.943263 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:38:14.943621 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m06:38:14.944403 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:38:14.946234 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m06:38:14.946682 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:38:14.946972 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m06:38:14.948543 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m06:38:14.951540 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."films__dbt_backup"
[0m06:38:14.951991 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:38:14.952299 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m06:38:14.954207 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m06:38:14.955304 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m06:38:14.955737 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed7812ec-f979-4cb7-83b6-ad60c1d8ee7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ea8048c230>]}
[0m06:38:14.956225 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.03s]
[0m06:38:14.956675 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m06:38:14.957383 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m06:38:14.957697 [info ] [Thread-1 (]: 4 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m06:38:14.957995 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.films, now model.custom_postgres.film_ratings)
[0m06:38:14.958319 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m06:38:14.962042 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m06:38:14.962473 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m06:38:14.964540 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m06:38:14.964930 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m06:38:14.965185 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m06:38:14.965426 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:38:14.970504 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m06:38:14.970840 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m06:38:14.971112 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  
  
    as
  
  (
    

WITH films_with_ratings AS (
    SELECT
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        

CASE
    WHEN user_rating >= 4.5 THEN 'Excellent'
    WHEN user_rating >= 4.0 THEN 'Good'
    WHEN user_rating >= 3.0 THEN 'Average'
    ELSE 'Poor'
END AS rating_category


    FROM "destination_db"."public"."films"
),

films_with_actors AS (
    SELECT
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ', ') AS actors
    FROM "destination_db"."public"."films" AS f
    LEFT JOIN "destination_db"."public"."film_actors" AS fa ON fa.film_id = f.film_id
    LEFT JOIN "destination_db"."public"."actors" AS a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title
)

SELECT
    fwf.*,
    fwa.actors
FROM films_with_ratings AS fwf
LEFT JOIN films_with_actors AS fwa ON fwf.film_id = fwa.film_id


  );
  
[0m06:38:14.973784 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.002 seconds
[0m06:38:14.976392 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m06:38:14.976657 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings__dbt_tmp" rename to "film_ratings"
[0m06:38:14.977062 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:38:14.978042 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m06:38:14.978286 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m06:38:14.978513 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m06:38:14.979227 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m06:38:14.980921 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."film_ratings__dbt_backup"
[0m06:38:14.981457 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m06:38:14.981817 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
drop table if exists "destination_db"."public"."film_ratings__dbt_backup" cascade
[0m06:38:14.982732 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m06:38:14.984186 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m06:38:14.984659 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed7812ec-f979-4cb7-83b6-ad60c1d8ee7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ea8049bdd0>]}
[0m06:38:14.985210 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public.film_ratings .......................... [[32mSELECT 20[0m in 0.03s]
[0m06:38:14.985728 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m06:38:14.987244 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:14.987827 [debug] [MainThread]: On master: BEGIN
[0m06:38:14.988260 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:38:14.993461 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m06:38:14.993750 [debug] [MainThread]: On master: COMMIT
[0m06:38:14.993972 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:14.994200 [debug] [MainThread]: On master: COMMIT
[0m06:38:14.994486 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:38:14.994711 [debug] [MainThread]: On master: Close
[0m06:38:14.995089 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:38:14.995364 [debug] [MainThread]: Connection 'model.custom_postgres.film_ratings' was properly closed.
[0m06:38:14.995736 [info ] [MainThread]: 
[0m06:38:14.996065 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m06:38:14.997392 [debug] [MainThread]: Command end result
[0m06:38:15.020409 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m06:38:15.021909 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m06:38:15.027216 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m06:38:15.027442 [info ] [MainThread]: 
[0m06:38:15.027716 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:38:15.027956 [info ] [MainThread]: 
[0m06:38:15.028255 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m06:38:15.029104 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.9846151, "process_in_blocks": "0", "process_kernel_time": 0.273499, "process_mem_max_rss": "106792", "process_out_blocks": "2048", "process_user_time": 1.747802}
[0m06:38:15.029515 [debug] [MainThread]: Command `dbt run` succeeded at 06:38:15.029429 after 0.99 seconds
[0m06:38:15.029792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ea82fb7aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ea831b4fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ea804b0d10>]}
[0m06:38:15.030076 [debug] [MainThread]: Flushing usage events
[0m06:38:16.608698 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:40:58.739854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f91757980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f91757a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f92038cb0>]}


============================== 06:40:58.742382 | 16a72658-80b8-48be-91fd-4f71a6bc0102 ==============================
[0m06:40:58.742382 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:40:58.742776 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/root', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:40:58.892856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '16a72658-80b8-48be-91fd-4f71a6bc0102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f916e3ef0>]}
[0m06:40:58.945516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '16a72658-80b8-48be-91fd-4f71a6bc0102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f91d8f440>]}
[0m06:40:58.946297 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:40:59.036196 [debug] [MainThread]: checksum: 568f1e1480817ea4790fb17980df195247d39d7f280a19e6fa3c1e276e1d1417, vars: {}, profile: custom_postgres, target: dev, version: 1.9.0
[0m06:40:59.148399 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m06:40:59.148915 [debug] [MainThread]: Partial parsing: added file: custom_postgres://models/example/specific_movie.sql
[0m06:40:59.405317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '16a72658-80b8-48be-91fd-4f71a6bc0102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f8fe2baa0>]}
[0m06:40:59.485894 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m06:40:59.488192 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m06:40:59.504787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '16a72658-80b8-48be-91fd-4f71a6bc0102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f8fbd7260>]}
[0m06:40:59.505216 [info ] [MainThread]: Found 5 models, 20 data tests, 3 sources, 431 macros
[0m06:40:59.505487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16a72658-80b8-48be-91fd-4f71a6bc0102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f8fb2e420>]}
[0m06:40:59.507548 [info ] [MainThread]: 
[0m06:40:59.507835 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:40:59.508083 [info ] [MainThread]: 
[0m06:40:59.508507 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:40:59.512442 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m06:40:59.549429 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m06:40:59.549746 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m06:40:59.549952 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:40:59.557247 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.007 seconds
[0m06:40:59.558392 [debug] [ThreadPool]: On list_destination_db: Close
[0m06:40:59.559688 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_destination_db, now list_destination_db_public)
[0m06:40:59.565438 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m06:40:59.565661 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m06:40:59.565850 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:40:59.571183 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m06:40:59.571686 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m06:40:59.571912 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m06:40:59.574921 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.003 seconds
[0m06:40:59.576277 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m06:40:59.576611 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m06:40:59.581699 [debug] [MainThread]: Using postgres connection "master"
[0m06:40:59.581952 [debug] [MainThread]: On master: BEGIN
[0m06:40:59.582174 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:40:59.587570 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m06:40:59.588156 [debug] [MainThread]: Using postgres connection "master"
[0m06:40:59.588468 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:40:59.592161 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m06:40:59.593643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16a72658-80b8-48be-91fd-4f71a6bc0102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f8fbd6fc0>]}
[0m06:40:59.594006 [debug] [MainThread]: On master: ROLLBACK
[0m06:40:59.594405 [debug] [MainThread]: Using postgres connection "master"
[0m06:40:59.594641 [debug] [MainThread]: On master: BEGIN
[0m06:40:59.595186 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:40:59.595474 [debug] [MainThread]: On master: COMMIT
[0m06:40:59.595749 [debug] [MainThread]: Using postgres connection "master"
[0m06:40:59.595992 [debug] [MainThread]: On master: COMMIT
[0m06:40:59.596382 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:40:59.596793 [debug] [MainThread]: On master: Close
[0m06:40:59.599375 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m06:40:59.599972 [info ] [Thread-1 (]: 1 of 5 START sql table model public.actors ..................................... [RUN]
[0m06:40:59.600399 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_destination_db_public, now model.custom_postgres.actors)
[0m06:40:59.600718 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m06:40:59.606702 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m06:40:59.607270 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m06:40:59.639550 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m06:40:59.640307 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:40:59.640559 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m06:40:59.640784 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:40:59.646314 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m06:40:59.646685 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:40:59.646935 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m06:40:59.648280 [debug] [Thread-1 (]: SQL status: SELECT 40 in 0.001 seconds
[0m06:40:59.653260 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:40:59.653527 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m06:40:59.653936 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:40:59.655866 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:40:59.656136 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m06:40:59.656497 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:40:59.672255 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m06:40:59.672645 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:40:59.672879 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m06:40:59.673906 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m06:40:59.678703 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."actors__dbt_backup"
[0m06:40:59.683055 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:40:59.683340 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m06:40:59.685192 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m06:40:59.687092 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m06:40:59.688294 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16a72658-80b8-48be-91fd-4f71a6bc0102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f8fe2bc20>]}
[0m06:40:59.688775 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.actors ................................ [[32mSELECT 40[0m in 0.09s]
[0m06:40:59.689250 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m06:40:59.689606 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m06:40:59.690123 [info ] [Thread-1 (]: 2 of 5 START sql table model public.film_actors ................................ [RUN]
[0m06:40:59.690453 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.actors, now model.custom_postgres.film_actors)
[0m06:40:59.690702 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m06:40:59.692671 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m06:40:59.693099 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m06:40:59.695347 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m06:40:59.695792 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:40:59.696042 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m06:40:59.696276 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:40:59.703013 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m06:40:59.703472 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:40:59.703717 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m06:40:59.705520 [debug] [Thread-1 (]: SQL status: SELECT 40 in 0.002 seconds
[0m06:40:59.708431 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:40:59.708752 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m06:40:59.709283 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:40:59.711392 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:40:59.711641 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m06:40:59.712093 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:40:59.713184 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m06:40:59.713430 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:40:59.713658 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m06:40:59.714407 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m06:40:59.715805 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."film_actors__dbt_backup"
[0m06:40:59.716274 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:40:59.716535 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m06:40:59.717997 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m06:40:59.718990 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m06:40:59.719433 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16a72658-80b8-48be-91fd-4f71a6bc0102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f8ec7ec30>]}
[0m06:40:59.719854 [info ] [Thread-1 (]: 2 of 5 OK created sql table model public.film_actors ........................... [[32mSELECT 40[0m in 0.03s]
[0m06:40:59.720315 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m06:40:59.720650 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m06:40:59.721087 [info ] [Thread-1 (]: 3 of 5 START sql table model public.films ...................................... [RUN]
[0m06:40:59.721398 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.film_actors, now model.custom_postgres.films)
[0m06:40:59.721699 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m06:40:59.723602 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m06:40:59.724006 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m06:40:59.727127 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m06:40:59.727514 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:40:59.727752 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m06:40:59.727975 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:40:59.732991 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m06:40:59.733386 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:40:59.733625 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m06:40:59.735874 [debug] [Thread-1 (]: SQL status: SELECT 40 in 0.002 seconds
[0m06:40:59.738622 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:40:59.738884 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m06:40:59.739362 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:40:59.741343 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:40:59.741602 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m06:40:59.742010 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:40:59.743090 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m06:40:59.743339 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:40:59.743564 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m06:40:59.744331 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m06:40:59.745753 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."films__dbt_backup"
[0m06:40:59.746136 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:40:59.746383 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m06:40:59.748067 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m06:40:59.749018 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m06:40:59.749439 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16a72658-80b8-48be-91fd-4f71a6bc0102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f8eb7fe00>]}
[0m06:40:59.749853 [info ] [Thread-1 (]: 3 of 5 OK created sql table model public.films ................................. [[32mSELECT 40[0m in 0.03s]
[0m06:40:59.750315 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m06:40:59.751170 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m06:40:59.751484 [info ] [Thread-1 (]: 4 of 5 START sql table model public.film_ratings ............................... [RUN]
[0m06:40:59.751786 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.films, now model.custom_postgres.film_ratings)
[0m06:40:59.752088 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m06:40:59.755731 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m06:40:59.756171 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m06:40:59.758280 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m06:40:59.758680 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m06:40:59.758932 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m06:40:59.759175 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:40:59.764469 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m06:40:59.764795 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m06:40:59.765076 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  
  
    as
  
  (
    

WITH films_with_ratings AS (
    SELECT
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        

CASE
    WHEN user_rating >= 4.5 THEN 'Excellent'
    WHEN user_rating >= 4.0 THEN 'Good'
    WHEN user_rating >= 3.0 THEN 'Average'
    ELSE 'Poor'
END AS rating_category


    FROM "destination_db"."public"."films"
),

films_with_actors AS (
    SELECT
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ', ') AS actors
    FROM "destination_db"."public"."films" AS f
    LEFT JOIN "destination_db"."public"."film_actors" AS fa ON fa.film_id = f.film_id
    LEFT JOIN "destination_db"."public"."actors" AS a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title
)

SELECT
    fwf.*,
    fwa.actors
FROM films_with_ratings AS fwf
LEFT JOIN films_with_actors AS fwa ON fwf.film_id = fwa.film_id


  );
  
[0m06:40:59.767909 [debug] [Thread-1 (]: SQL status: SELECT 40 in 0.003 seconds
[0m06:40:59.771370 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m06:40:59.771659 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings" rename to "film_ratings__dbt_backup"
[0m06:40:59.772274 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:40:59.774316 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m06:40:59.774563 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings__dbt_tmp" rename to "film_ratings"
[0m06:40:59.774942 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:40:59.776020 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m06:40:59.776332 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m06:40:59.776563 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m06:40:59.777534 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m06:40:59.779013 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."film_ratings__dbt_backup"
[0m06:40:59.779397 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m06:40:59.779636 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
drop table if exists "destination_db"."public"."film_ratings__dbt_backup" cascade
[0m06:40:59.781368 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m06:40:59.782779 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m06:40:59.783183 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16a72658-80b8-48be-91fd-4f71a6bc0102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f8eb7e570>]}
[0m06:40:59.783609 [info ] [Thread-1 (]: 4 of 5 OK created sql table model public.film_ratings .......................... [[32mSELECT 40[0m in 0.03s]
[0m06:40:59.784093 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m06:40:59.784408 [debug] [Thread-1 (]: Began running node model.custom_postgres.specific_movie
[0m06:40:59.784802 [info ] [Thread-1 (]: 5 of 5 START sql table model public.specific_movie ............................. [RUN]
[0m06:40:59.785134 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.film_ratings, now model.custom_postgres.specific_movie)
[0m06:40:59.785427 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.specific_movie
[0m06:40:59.787646 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.specific_movie"
[0m06:40:59.788043 [debug] [Thread-1 (]: Began executing node model.custom_postgres.specific_movie
[0m06:40:59.790173 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.specific_movie"
[0m06:40:59.790525 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m06:40:59.790764 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: BEGIN
[0m06:40:59.790985 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:40:59.796475 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m06:40:59.796946 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m06:40:59.797237 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */

  
    

  create  table "destination_db"."public"."specific_movie__dbt_tmp"
  
  
    as
  
  (
    

SELECT *
FROM "destination_db"."public"."films"
WHERE title = 'Dunkirk'
  );
  
[0m06:40:59.800810 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.003 seconds
[0m06:40:59.803654 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m06:40:59.803960 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */
alter table "destination_db"."public"."specific_movie__dbt_tmp" rename to "specific_movie"
[0m06:40:59.804405 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:40:59.806631 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: COMMIT
[0m06:40:59.806880 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m06:40:59.807118 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: COMMIT
[0m06:40:59.808097 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m06:40:59.809512 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."specific_movie__dbt_backup"
[0m06:40:59.809904 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m06:40:59.810162 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */
drop table if exists "destination_db"."public"."specific_movie__dbt_backup" cascade
[0m06:40:59.810521 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m06:40:59.811481 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: Close
[0m06:40:59.811870 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16a72658-80b8-48be-91fd-4f71a6bc0102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f8ebabc20>]}
[0m06:40:59.812545 [info ] [Thread-1 (]: 5 of 5 OK created sql table model public.specific_movie ........................ [[32mSELECT 2[0m in 0.03s]
[0m06:40:59.813334 [debug] [Thread-1 (]: Finished running node model.custom_postgres.specific_movie
[0m06:40:59.814545 [debug] [MainThread]: Using postgres connection "master"
[0m06:40:59.814884 [debug] [MainThread]: On master: BEGIN
[0m06:40:59.815113 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:40:59.819750 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m06:40:59.820123 [debug] [MainThread]: On master: COMMIT
[0m06:40:59.820355 [debug] [MainThread]: Using postgres connection "master"
[0m06:40:59.820569 [debug] [MainThread]: On master: COMMIT
[0m06:40:59.820846 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:40:59.821078 [debug] [MainThread]: On master: Close
[0m06:40:59.821428 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:40:59.821632 [debug] [MainThread]: Connection 'model.custom_postgres.specific_movie' was properly closed.
[0m06:40:59.821935 [info ] [MainThread]: 
[0m06:40:59.822224 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m06:40:59.823426 [debug] [MainThread]: Command end result
[0m06:40:59.845826 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m06:40:59.847405 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m06:40:59.853291 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m06:40:59.853513 [info ] [MainThread]: 
[0m06:40:59.853783 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:40:59.854023 [info ] [MainThread]: 
[0m06:40:59.854327 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m06:40:59.855183 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.1938375, "process_in_blocks": "0", "process_kernel_time": 0.27915, "process_mem_max_rss": "110420", "process_out_blocks": "2984", "process_user_time": 1.940095}
[0m06:40:59.855560 [debug] [MainThread]: Command `dbt run` succeeded at 06:40:59.855477 after 1.19 seconds
[0m06:40:59.855830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f921728d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f91cf9730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f93265be0>]}
[0m06:40:59.856106 [debug] [MainThread]: Flushing usage events
[0m06:41:01.266369 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:42:03.535765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a6a0f69a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a6a187a840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a6a0f6a030>]}


============================== 06:42:03.541475 | 999f1ab8-f2dd-43e2-873f-bfb0768d7091 ==============================
[0m06:42:03.541475 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:42:03.541867 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/dbt/logs', 'profiles_dir': '/root', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'send_anonymous_usage_stats': 'True'}
[0m06:42:03.727464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '999f1ab8-f2dd-43e2-873f-bfb0768d7091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a6a0a816d0>]}
[0m06:42:03.781585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '999f1ab8-f2dd-43e2-873f-bfb0768d7091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a6a0a816d0>]}
[0m06:42:03.782183 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:42:03.870434 [debug] [MainThread]: checksum: 568f1e1480817ea4790fb17980df195247d39d7f280a19e6fa3c1e276e1d1417, vars: {}, profile: custom_postgres, target: dev, version: 1.9.0
[0m06:42:03.981619 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:42:03.981954 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:42:04.026148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '999f1ab8-f2dd-43e2-873f-bfb0768d7091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a6a0a80770>]}
[0m06:42:04.107731 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m06:42:04.110166 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m06:42:04.132660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '999f1ab8-f2dd-43e2-873f-bfb0768d7091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a69ec78170>]}
[0m06:42:04.133061 [info ] [MainThread]: Found 5 models, 20 data tests, 3 sources, 431 macros
[0m06:42:04.133325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '999f1ab8-f2dd-43e2-873f-bfb0768d7091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a69ef7eb70>]}
[0m06:42:04.135094 [info ] [MainThread]: 
[0m06:42:04.135365 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:42:04.135614 [info ] [MainThread]: 
[0m06:42:04.136062 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:42:04.140055 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m06:42:04.177843 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m06:42:04.178151 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m06:42:04.178356 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:42:04.187284 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.009 seconds
[0m06:42:04.188342 [debug] [ThreadPool]: On list_destination_db: Close
[0m06:42:04.189871 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_destination_db, now list_destination_db_public)
[0m06:42:04.194957 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m06:42:04.195190 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m06:42:04.195382 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:42:04.199935 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m06:42:04.200244 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m06:42:04.200523 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m06:42:04.203572 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m06:42:04.204580 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m06:42:04.204852 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m06:42:04.208980 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:04.209279 [debug] [MainThread]: On master: BEGIN
[0m06:42:04.209507 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:42:04.214337 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m06:42:04.214649 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:04.214930 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:42:04.218008 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m06:42:04.219265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '999f1ab8-f2dd-43e2-873f-bfb0768d7091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a69f0b0980>]}
[0m06:42:04.219624 [debug] [MainThread]: On master: ROLLBACK
[0m06:42:04.219930 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:04.220169 [debug] [MainThread]: On master: BEGIN
[0m06:42:04.220510 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:42:04.220761 [debug] [MainThread]: On master: COMMIT
[0m06:42:04.220988 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:04.221211 [debug] [MainThread]: On master: COMMIT
[0m06:42:04.221488 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:42:04.221713 [debug] [MainThread]: On master: Close
[0m06:42:04.223658 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m06:42:04.224590 [info ] [Thread-1 (]: 1 of 5 START sql table model public.actors ..................................... [RUN]
[0m06:42:04.225434 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_destination_db_public, now model.custom_postgres.actors)
[0m06:42:04.226132 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m06:42:04.236324 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m06:42:04.237235 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m06:42:04.286465 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m06:42:04.286981 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:42:04.287247 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m06:42:04.287472 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:42:04.293185 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m06:42:04.293545 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:42:04.293787 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m06:42:04.294223 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                           ^

[0m06:42:04.294466 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m06:42:04.294829 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m06:42:04.297566 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/actors.sql
[0m06:42:04.298792 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '999f1ab8-f2dd-43e2-873f-bfb0768d7091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a69e0f9700>]}
[0m06:42:04.299250 [error] [Thread-1 (]: 1 of 5 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.07s]
[0m06:42:04.299688 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m06:42:04.299975 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m06:42:04.300477 [debug] [Thread-4 (]: Marking all children of 'model.custom_postgres.actors' to be skipped because of status 'error'.  Reason: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/actors.sql.
[0m06:42:04.300968 [info ] [Thread-1 (]: 2 of 5 START sql table model public.film_actors ................................ [RUN]
[0m06:42:04.302660 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.actors, now model.custom_postgres.film_actors)
[0m06:42:04.302908 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m06:42:04.305161 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m06:42:04.305595 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m06:42:04.307614 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m06:42:04.307991 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:42:04.308243 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m06:42:04.308467 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:42:04.313835 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m06:42:04.314246 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:42:04.314498 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m06:42:04.314966 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                           ^

[0m06:42:04.315347 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m06:42:04.315858 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m06:42:04.318625 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/film_actors.sql
[0m06:42:04.319114 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '999f1ab8-f2dd-43e2-873f-bfb0768d7091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a69ec8bbc0>]}
[0m06:42:04.319597 [error] [Thread-1 (]: 2 of 5 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.02s]
[0m06:42:04.320119 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m06:42:04.320406 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m06:42:04.320744 [debug] [Thread-4 (]: Marking all children of 'model.custom_postgres.film_actors' to be skipped because of status 'error'.  Reason: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/film_actors.sql.
[0m06:42:04.321087 [info ] [Thread-1 (]: 3 of 5 START sql table model public.films ...................................... [RUN]
[0m06:42:04.321576 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.film_actors, now model.custom_postgres.films)
[0m06:42:04.321865 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m06:42:04.323949 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m06:42:04.324399 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m06:42:04.326495 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m06:42:04.326913 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:42:04.327171 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m06:42:04.327401 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:42:04.333056 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m06:42:04.333477 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:42:04.333733 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m06:42:04.334210 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."films"
                           ^

[0m06:42:04.334520 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m06:42:04.334878 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m06:42:04.336898 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled code at target/run/custom_postgres/models/example/films.sql
[0m06:42:04.337298 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '999f1ab8-f2dd-43e2-873f-bfb0768d7091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a69df17590>]}
[0m06:42:04.337745 [error] [Thread-1 (]: 3 of 5 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.02s]
[0m06:42:04.338190 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m06:42:04.338934 [debug] [Thread-4 (]: Marking all children of 'model.custom_postgres.films' to be skipped because of status 'error'.  Reason: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled code at target/run/custom_postgres/models/example/films.sql.
[0m06:42:04.339963 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m06:42:04.340338 [info ] [Thread-1 (]: 4 of 5 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m06:42:04.340649 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m06:42:04.340934 [debug] [Thread-1 (]: Began running node model.custom_postgres.specific_movie
[0m06:42:04.341260 [info ] [Thread-1 (]: 5 of 5 SKIP relation public.specific_movie ..................................... [[33mSKIP[0m]
[0m06:42:04.341556 [debug] [Thread-1 (]: Finished running node model.custom_postgres.specific_movie
[0m06:42:04.342590 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:04.342833 [debug] [MainThread]: On master: BEGIN
[0m06:42:04.343071 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:42:04.348178 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m06:42:04.348456 [debug] [MainThread]: On master: COMMIT
[0m06:42:04.348675 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:04.348887 [debug] [MainThread]: On master: COMMIT
[0m06:42:04.349177 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:42:04.349400 [debug] [MainThread]: On master: Close
[0m06:42:04.349730 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:42:04.349931 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m06:42:04.350230 [info ] [MainThread]: 
[0m06:42:04.350496 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.21 seconds (0.21s).
[0m06:42:04.351595 [debug] [MainThread]: Command end result
[0m06:42:04.374098 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m06:42:04.375376 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m06:42:04.380482 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m06:42:04.380706 [info ] [MainThread]: 
[0m06:42:04.380993 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m06:42:04.381268 [info ] [MainThread]: 
[0m06:42:04.381628 [error] [MainThread]:   Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/actors.sql
[0m06:42:04.381905 [info ] [MainThread]: 
[0m06:42:04.382275 [error] [MainThread]:   Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled code at target/run/custom_postgres/models/example/film_actors.sql
[0m06:42:04.382575 [info ] [MainThread]: 
[0m06:42:04.382960 [error] [MainThread]:   Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled code at target/run/custom_postgres/models/example/films.sql
[0m06:42:04.383286 [info ] [MainThread]: 
[0m06:42:04.383630 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=2 TOTAL=5
[0m06:42:04.384665 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.8892586, "process_in_blocks": "0", "process_kernel_time": 0.273997, "process_mem_max_rss": "108140", "process_out_blocks": "3616", "process_user_time": 1.705983}
[0m06:42:04.385095 [debug] [MainThread]: Command `dbt run` failed at 06:42:04.384992 after 0.89 seconds
[0m06:42:04.385408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a6a0f6a030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a6a09dc4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a6a0c5f6e0>]}
[0m06:42:04.385750 [debug] [MainThread]: Flushing usage events
[0m06:42:05.689747 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:42:12.454894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73741674b740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7374164df530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73741674a9f0>]}


============================== 06:42:12.458600 | 5c5d87a5-ce1e-4706-b814-aa715d6136cf ==============================
[0m06:42:12.458600 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:42:12.459037 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/root', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'send_anonymous_usage_stats': 'True'}
[0m06:42:12.604862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c5d87a5-ce1e-4706-b814-aa715d6136cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7374160f50a0>]}
[0m06:42:12.658335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c5d87a5-ce1e-4706-b814-aa715d6136cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737417038ef0>]}
[0m06:42:12.659015 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:42:12.745875 [debug] [MainThread]: checksum: 568f1e1480817ea4790fb17980df195247d39d7f280a19e6fa3c1e276e1d1417, vars: {}, profile: custom_postgres, target: dev, version: 1.9.0
[0m06:42:12.854221 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:42:12.854520 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:42:12.897847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c5d87a5-ce1e-4706-b814-aa715d6136cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737414294ce0>]}
[0m06:42:12.980285 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m06:42:12.982486 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m06:42:12.997153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c5d87a5-ce1e-4706-b814-aa715d6136cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73741400c5c0>]}
[0m06:42:12.997541 [info ] [MainThread]: Found 5 models, 20 data tests, 3 sources, 431 macros
[0m06:42:12.997830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c5d87a5-ce1e-4706-b814-aa715d6136cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737414294f20>]}
[0m06:42:12.999659 [info ] [MainThread]: 
[0m06:42:12.999927 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:42:13.000188 [info ] [MainThread]: 
[0m06:42:13.000626 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:42:13.004633 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m06:42:13.045959 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m06:42:13.046285 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m06:42:13.046525 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:42:13.054186 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.008 seconds
[0m06:42:13.055404 [debug] [ThreadPool]: On list_destination_db: Close
[0m06:42:13.057056 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_destination_db, now list_destination_db_public)
[0m06:42:13.063293 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m06:42:13.063568 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m06:42:13.063765 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:42:13.068466 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m06:42:13.068802 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m06:42:13.069048 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m06:42:13.071665 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m06:42:13.072801 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m06:42:13.073097 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m06:42:13.078802 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:13.079112 [debug] [MainThread]: On master: BEGIN
[0m06:42:13.079340 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:42:13.084922 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m06:42:13.085307 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:13.085626 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:42:13.088724 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m06:42:13.090540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c5d87a5-ce1e-4706-b814-aa715d6136cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737413fde510>]}
[0m06:42:13.090941 [debug] [MainThread]: On master: ROLLBACK
[0m06:42:13.091267 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:13.091514 [debug] [MainThread]: On master: BEGIN
[0m06:42:13.091914 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:42:13.092155 [debug] [MainThread]: On master: COMMIT
[0m06:42:13.092369 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:13.092648 [debug] [MainThread]: On master: COMMIT
[0m06:42:13.092942 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:42:13.093183 [debug] [MainThread]: On master: Close
[0m06:42:13.094921 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m06:42:13.095501 [info ] [Thread-1 (]: 1 of 5 START sql table model public.actors ..................................... [RUN]
[0m06:42:13.095868 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_destination_db_public, now model.custom_postgres.actors)
[0m06:42:13.096191 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m06:42:13.103055 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m06:42:13.103576 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m06:42:13.134334 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m06:42:13.134894 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:42:13.135149 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m06:42:13.135376 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:42:13.141956 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m06:42:13.142385 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:42:13.142642 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m06:42:13.143925 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.001 seconds
[0m06:42:13.148950 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:42:13.149255 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m06:42:13.149818 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:42:13.151965 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:42:13.152238 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m06:42:13.152756 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:42:13.168455 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m06:42:13.168741 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:42:13.168972 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m06:42:13.169795 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m06:42:13.174368 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."actors__dbt_backup"
[0m06:42:13.178461 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:42:13.178716 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m06:42:13.180670 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m06:42:13.182583 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m06:42:13.183821 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c5d87a5-ce1e-4706-b814-aa715d6136cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737417876300>]}
[0m06:42:13.184285 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.09s]
[0m06:42:13.184771 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m06:42:13.185078 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m06:42:13.185515 [info ] [Thread-1 (]: 2 of 5 START sql table model public.film_actors ................................ [RUN]
[0m06:42:13.185844 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.actors, now model.custom_postgres.film_actors)
[0m06:42:13.186136 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m06:42:13.188274 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m06:42:13.188722 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m06:42:13.190979 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m06:42:13.191451 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:42:13.191704 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m06:42:13.191934 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:42:13.197384 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m06:42:13.197665 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:42:13.197901 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m06:42:13.199274 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.001 seconds
[0m06:42:13.201521 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:42:13.201799 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m06:42:13.202364 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:42:13.204394 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:42:13.204671 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m06:42:13.205086 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:42:13.207098 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m06:42:13.207346 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:42:13.207577 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m06:42:13.208356 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m06:42:13.209903 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."film_actors__dbt_backup"
[0m06:42:13.210275 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:42:13.210509 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m06:42:13.212593 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m06:42:13.213640 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m06:42:13.214051 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c5d87a5-ce1e-4706-b814-aa715d6136cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7374118963c0>]}
[0m06:42:13.214479 [info ] [Thread-1 (]: 2 of 5 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.03s]
[0m06:42:13.214934 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m06:42:13.215250 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m06:42:13.215674 [info ] [Thread-1 (]: 3 of 5 START sql table model public.films ...................................... [RUN]
[0m06:42:13.215979 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.film_actors, now model.custom_postgres.films)
[0m06:42:13.216247 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m06:42:13.218159 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m06:42:13.218583 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m06:42:13.220802 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m06:42:13.221240 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:42:13.221481 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m06:42:13.221753 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:42:13.227177 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m06:42:13.227520 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:42:13.227762 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m06:42:13.229008 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.001 seconds
[0m06:42:13.231322 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:42:13.231574 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m06:42:13.232096 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:42:13.234053 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:42:13.234302 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m06:42:13.234667 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:42:13.235678 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m06:42:13.235925 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:42:13.236163 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m06:42:13.236847 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m06:42:13.238315 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."films__dbt_backup"
[0m06:42:13.238671 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:42:13.238906 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m06:42:13.240646 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m06:42:13.241602 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m06:42:13.242006 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c5d87a5-ce1e-4706-b814-aa715d6136cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737411869d90>]}
[0m06:42:13.242423 [info ] [Thread-1 (]: 3 of 5 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.03s]
[0m06:42:13.242862 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m06:42:13.243651 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m06:42:13.244023 [info ] [Thread-1 (]: 4 of 5 START sql table model public.film_ratings ............................... [RUN]
[0m06:42:13.244337 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.films, now model.custom_postgres.film_ratings)
[0m06:42:13.244629 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m06:42:13.248287 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m06:42:13.248757 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m06:42:13.251047 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m06:42:13.251461 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m06:42:13.251694 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m06:42:13.251936 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:42:13.257784 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m06:42:13.258159 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m06:42:13.258423 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  
  
    as
  
  (
    

WITH films_with_ratings AS (
    SELECT
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        

CASE
    WHEN user_rating >= 4.5 THEN 'Excellent'
    WHEN user_rating >= 4.0 THEN 'Good'
    WHEN user_rating >= 3.0 THEN 'Average'
    ELSE 'Poor'
END AS rating_category


    FROM "destination_db"."public"."films"
),

films_with_actors AS (
    SELECT
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ', ') AS actors
    FROM "destination_db"."public"."films" AS f
    LEFT JOIN "destination_db"."public"."film_actors" AS fa ON fa.film_id = f.film_id
    LEFT JOIN "destination_db"."public"."actors" AS a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title
)

SELECT
    fwf.*,
    fwa.actors
FROM films_with_ratings AS fwf
LEFT JOIN films_with_actors AS fwa ON fwf.film_id = fwa.film_id


  );
  
[0m06:42:13.261142 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.002 seconds
[0m06:42:13.264128 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m06:42:13.264407 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings__dbt_tmp" rename to "film_ratings"
[0m06:42:13.264861 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:42:13.265820 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m06:42:13.266067 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m06:42:13.266301 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m06:42:13.267074 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m06:42:13.268542 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."film_ratings__dbt_backup"
[0m06:42:13.268944 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m06:42:13.269188 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
drop table if exists "destination_db"."public"."film_ratings__dbt_backup" cascade
[0m06:42:13.269589 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m06:42:13.270548 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m06:42:13.271024 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c5d87a5-ce1e-4706-b814-aa715d6136cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73741187dc70>]}
[0m06:42:13.271463 [info ] [Thread-1 (]: 4 of 5 OK created sql table model public.film_ratings .......................... [[32mSELECT 20[0m in 0.03s]
[0m06:42:13.271885 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m06:42:13.272195 [debug] [Thread-1 (]: Began running node model.custom_postgres.specific_movie
[0m06:42:13.272726 [info ] [Thread-1 (]: 5 of 5 START sql table model public.specific_movie ............................. [RUN]
[0m06:42:13.273105 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.film_ratings, now model.custom_postgres.specific_movie)
[0m06:42:13.273446 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.specific_movie
[0m06:42:13.275604 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.specific_movie"
[0m06:42:13.276026 [debug] [Thread-1 (]: Began executing node model.custom_postgres.specific_movie
[0m06:42:13.279350 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.specific_movie"
[0m06:42:13.279745 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m06:42:13.279992 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: BEGIN
[0m06:42:13.280226 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:42:13.286064 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m06:42:13.286447 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m06:42:13.286698 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */

  
    

  create  table "destination_db"."public"."specific_movie__dbt_tmp"
  
  
    as
  
  (
    

SELECT *
FROM "destination_db"."public"."films"
WHERE title = 'Dunkirk'
  );
  
[0m06:42:13.288196 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m06:42:13.290390 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m06:42:13.290635 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */
alter table "destination_db"."public"."specific_movie__dbt_tmp" rename to "specific_movie"
[0m06:42:13.291019 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:42:13.291969 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: COMMIT
[0m06:42:13.292215 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m06:42:13.292439 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: COMMIT
[0m06:42:13.293108 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m06:42:13.294507 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."specific_movie__dbt_backup"
[0m06:42:13.294863 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m06:42:13.295110 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */
drop table if exists "destination_db"."public"."specific_movie__dbt_backup" cascade
[0m06:42:13.295433 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m06:42:13.296397 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: Close
[0m06:42:13.296779 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c5d87a5-ce1e-4706-b814-aa715d6136cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7374118dd5b0>]}
[0m06:42:13.297190 [info ] [Thread-1 (]: 5 of 5 OK created sql table model public.specific_movie ........................ [[32mSELECT 1[0m in 0.02s]
[0m06:42:13.297616 [debug] [Thread-1 (]: Finished running node model.custom_postgres.specific_movie
[0m06:42:13.298841 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:13.299377 [debug] [MainThread]: On master: BEGIN
[0m06:42:13.299781 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:42:13.306007 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m06:42:13.306358 [debug] [MainThread]: On master: COMMIT
[0m06:42:13.306581 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:13.306793 [debug] [MainThread]: On master: COMMIT
[0m06:42:13.307085 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:42:13.307312 [debug] [MainThread]: On master: Close
[0m06:42:13.307642 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:42:13.307846 [debug] [MainThread]: Connection 'model.custom_postgres.specific_movie' was properly closed.
[0m06:42:13.308147 [info ] [MainThread]: 
[0m06:42:13.308416 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m06:42:13.309845 [debug] [MainThread]: Command end result
[0m06:42:13.342080 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m06:42:13.344187 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m06:42:13.350302 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m06:42:13.350542 [info ] [MainThread]: 
[0m06:42:13.350836 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:42:13.351121 [info ] [MainThread]: 
[0m06:42:13.351381 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m06:42:13.352220 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.9715142, "process_in_blocks": "0", "process_kernel_time": 0.279709, "process_mem_max_rss": "107248", "process_out_blocks": "2080", "process_user_time": 1.702232}
[0m06:42:13.352611 [debug] [MainThread]: Command `dbt run` succeeded at 06:42:13.352525 after 0.97 seconds
[0m06:42:13.352908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73741609bd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7374160c6420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737416664080>]}
[0m06:42:13.353197 [debug] [MainThread]: Flushing usage events
[0m06:42:14.669705 [debug] [MainThread]: An error was encountered while trying to flush usage events
